<!DOCTYPE html>
<!-- saved from url=(0056)https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>HTML5 Canvas でドラッグ操作 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport"><meta content="#55c500" name="theme-color"><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification"><link href="https://qiita.com/manifest.json" rel="manifest"><link href="https://qiita.com/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml"><meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="Ey5FBYOWtD4thGDbOac0urjr/VUnZkMrtzdaMXAkHPahgr4fJb+9JliwKn9ktH6yA7CsmUuozu8KO6526gEbFA=="><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico"><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png"><link rel="stylesheet" media="all" href="./HTML5 Canvas でドラッグ操作 - Qiita_files/style-0fd6016bcf4aab10d016631c4ef2c833.min.css"><script type="text/javascript" charset="UTF-8" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/lift.json"></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/saved_resource"></script><script async="" charset="utf-8" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/pixel"></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/lt.js"></script><script charset="utf-8" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/pixel2.js"></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/saved_resource(1)"></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/pixel.js"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/segmentation.js"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/segmentation.js"></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/uwt.js"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(6).txt"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(6).txt"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(6).txt"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(6).txt"></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/gtm.js"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/osd.js"></script><script type="text/javascript" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/combo" async=""></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/analytics.js"></script><script async="">window.a1tracker&&a1tracker.ready(function(tracker){var doh="ff9a3577423c8ed5";if(!doh)return;var params={"event":"","url":"","referrer":"","metakeywords":"","callback":""};if(params.url)tracker.setParams(doh,"url",params.url);if(params.referrer)tracker.setParams(doh,"referrer",params.referrer);if(params.metakeywords){var mk=tracker.getParams(doh,"metakeywords");Array.prototype.push.apply(mk,params.metakeywords.split(","));tracker.setParams(doh,"metakeywords",mk)}tracker.setParams(doh,"tagsource","itm_a1common");var callback=params.callback&&typeof window[params.callback]==="function"?function(err,data){if(!err&&data.segments.length>0)window[params.callback](data.segments);return}:function(){};if(params.event)tracker.send(doh,params.event.split(","),callback);else tracker.send(doh,callback)});</script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tracking.min.js"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/js"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(6).txt"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/1469129556533591" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/2040876882868599" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/1733466696949178" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/386990638325508" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/256605841418458" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/262978464137256" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/437265843064161" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/954575148009345" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/996402550503199" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/809797712462041" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/1792588824374455" async=""></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/fbevents.js"></script><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/ff9a3577423c8ed5_4330.js"></script><script type="text/javascript" async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/td.min.js"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/v3-article-bundle-de953769f2f11e4c33c9a9000f1b8685.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site"><meta content="@__kyrieleison__" name="twitter:creator"><meta property="og:type" content="article"><meta property="og:title" content="HTML5 Canvas でドラッグ操作 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-1.2.2&amp;w=1200&amp;mark=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D380%26txt%3DHTML5%2520Canvas%2520%25E3%2581%25A7%25E3%2583%2589%25E3%2583%25A9%25E3%2583%2583%25E3%2582%25B0%25E6%2593%258D%25E4%25BD%259C%26txt-color%3D%2523333%26txt-font%3DHiragino%2520Sans%2520W6%26txt-size%3D54%26txt-clip%3Dellipsis%26txt-align%3Dcenter%252Cmiddle%26s%3D897dcab3d567504380ad5e9bdc53feaa&amp;mark-align=center%2Cmiddle&amp;blend=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D500%26txt%3D%2540kyrieleison%26txt-color%3D%2523333%26txt-font%3DHiragino%2520Sans%2520W6%26txt-size%3D45%26txt-align%3Dright%252Cbottom%26s%3D5263619810df56d5f919aaf288f04770&amp;blend-align=center%2Cmiddle&amp;blend-mode=normal&amp;s=64a1179481ca225f54f2927ca6398b4c"><meta property="og:description" content="以下の記事で HTML5 Canvas に入門しました。
http://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0

が、どうせなら描画した要素をドラッグでぐりぐり動かすくらいは、..."><meta content="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596" property="og:url"><meta content="Qiita" property="og:site_name"><meta content="564524038" property="fb:admins"><meta content="JavaScript,HTML5,canvas,入門" name="keywords"><style data-emotion-css="1lpnfiw 1gj7nt 154zy0m yikrym 1jqivyb 1ode1bp le4d8r ah51ux 4lkrad 1u064zm 1hbd3g7" }="">.css-1lpnfiw{display:none;right:0;top:24px;width:250px;}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-154zy0m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-154zy0m:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#F2F2F2;}.css-yikrym{width:20px;}.css-1jqivyb{color:rgba(0,0,0,0.6);font-size:13px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-le4d8r{display:inline-block;vertical-align:middle;height:13px;width:13px;fill:rgba(0,0,0,0.6);}.css-ah51ux{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#5D707C;}.css-4lkrad{display:inline-block;width:56px;height:12.747967479674797px;fill:#55C500;}.css-1u064zm{display:inline-block;border:2px solid #ccc;font-size:1.4rem;padding:4px 0;text-align:center;cursor:pointer;width:100%;background-color:#fff;color:#333;border-color:#ddd;font-weight:bold;}.css-1u064zm:hover{border-color:#adadad;background-color:#e6e6e6;color:#333;}.css-1hbd3g7{height:250px;}</style><script>window.frtn=window.frtn||function(){ (frtn.q=frtn.q||[]).push(arguments) };
frtn("init",{
service_id:"cova_248",
site_id:"site_134",
tag_id:"tag_283"
});
frtn("send","pageview");</script><script defer="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/insight.js" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/polyfill.min.js"></script><script>!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["addRecord","blockEvents","fetchServerCookie","fetchGlobalID","fetchUserSegments","resetUUID","ready","setSignedMode","setAnonymousMode","set","trackEvent","trackPageview","trackClicks","unblockEvents"],n=0;n<s.length;n++){var c=s[n];e[t].prototype[c]=r(c)}var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/2.5/td.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)}}("Treasure",this);

// Configure an instance for your database
var td = new Treasure({
  host: 'in.treasuredata.com',
  writeKey: '10614/e3887673c1849754466b09ad01b4fbbc22b88f30',
  database: 'qiita_public',
  startInSignedMode: true
});

var success = function() {
  syncGoogleDDPv2();
};

var failure = function() {
  syncGoogleDDPv2();
}

var syncGoogleDDPv2 = function() {
  var ddp_destination = 'cm.g.doubleclick.net/pixel'
      + '?google_nid=treasuredata_dmp'
      + '&google_hm=' + btoa(self.td.client.track.uuid).replace(/\//g, '_').replace(/\+/g, '-').replace(/=/g, '');

  var n = document.createElement("img");
  n.src = ("https:" == document.location.protocol ? "https://" : "http://") + ddp_destination;
  n.width = 1;
  n.height = 1;
  n.style.display = "none";
  document.body.appendChild(n);
}

// Enable cross-domain tracking
td.set('$global', 'td_global_id', 'td_global_id');
// Track pageview information to 'pageviews' table
td.set('pageviews_all', {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kyrieleison","type":"items","id":"26fcfb3a1d94bc92c596"},"user_id":null})
td.trackPageview('pageviews_all', success, failure);</script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/js(1)"></script><style data-emotion="css"></style><style data-jss="" data-meta="MuiTooltip">
.MuiTooltip-popper {
  flip: false;
  z-index: 1500;
  pointer-events: none;
}
.MuiTooltip-popperInteractive {
  pointer-events: auto;
}
.MuiTooltip-popperArrow[x-placement*="bottom"] .MuiTooltip-arrow {
  top: 0;
  flip: false;
  left: 0;
  width: 2em;
  height: 1em;
  margin-top: -0.95em;
  margin-left: 4px;
  margin-right: 4px;
}
.MuiTooltip-popperArrow[x-placement*="top"] .MuiTooltip-arrow {
  flip: false;
  left: 0;
  width: 2em;
  bottom: 0;
  height: 1em;
  margin-left: 4px;
  margin-right: 4px;
  margin-bottom: -0.95em;
}
.MuiTooltip-popperArrow[x-placement*="right"] .MuiTooltip-arrow {
  flip: false;
  left: 0;
  width: 1em;
  height: 2em;
  margin-top: 4px;
  margin-left: -0.95em;
  margin-bottom: 4px;
}
.MuiTooltip-popperArrow[x-placement*="left"] .MuiTooltip-arrow {
  flip: false;
  right: 0;
  width: 1em;
  height: 2em;
  margin-top: 4px;
  margin-right: -0.95em;
  margin-bottom: 4px;
}
.MuiTooltip-popperArrow[x-placement*="left"] .MuiTooltip-arrow::before {
  flip: false;
  border-color: transparent transparent transparent currentcolor;
  border-width: 1em 0 1em 1em;
}
.MuiTooltip-popperArrow[x-placement*="right"] .MuiTooltip-arrow::before {
  flip: false;
  border-color: transparent currentcolor transparent transparent;
  border-width: 1em 1em 1em 0;
}
.MuiTooltip-popperArrow[x-placement*="top"] .MuiTooltip-arrow::before {
  flip: false;
  border-color: currentcolor transparent transparent transparent;
  border-width: 1em 1em 0 1em;
}
.MuiTooltip-popperArrow[x-placement*="bottom"] .MuiTooltip-arrow::before {
  flip: false;
  border-color: transparent transparent currentcolor transparent;
  border-width: 0 1em 1em 1em;
}
.MuiTooltip-tooltip {
  color: #fff;
  padding: 4px 8px;
  font-size: 0.625rem;
  max-width: 300px;
  word-wrap: break-word;
  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
  font-weight: 500;
  line-height: 1.4em;
  border-radius: 4px;
  background-color: rgba(97, 97, 97, 0.9);
}
.MuiTooltip-tooltipArrow {
  margin: 0;
  position: relative;
}
.MuiTooltip-arrow {
  color: rgba(97, 97, 97, 0.9);
  position: absolute;
  font-size: 6px;
}
.MuiTooltip-arrow::before {
  width: 0;
  height: 0;
  margin: auto;
  content: "";
  display: block;
  border-style: solid;
}
.MuiTooltip-touch {
  padding: 8px 16px;
  font-size: 0.875rem;
  font-weight: 400;
  line-height: 1.14286em;
}
.MuiTooltip-tooltipPlacementLeft {
  margin: 0 24px ;
  transform-origin: right center;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementLeft {
    margin: 0 14px;
  }
}
.MuiTooltip-tooltipPlacementRight {
  margin: 0 24px;
  transform-origin: left center;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementRight {
    margin: 0 14px;
  }
}
.MuiTooltip-tooltipPlacementTop {
  margin: 24px 0;
  transform-origin: center bottom;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementTop {
    margin: 14px 0;
  }
}
.MuiTooltip-tooltipPlacementBottom {
  margin: 24px 0;
  transform-origin: center top;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementBottom {
    margin: 14px 0;
  }
}
</style><script type="text/x-mathjax-config">MathJax.Hub.Config({
    skipStartupTypeset: true,
    showProcessingMessages: false,
    tex2jax: {
      inlineMath: [['$', '$']],
      displayMath: [['$$', '$$']],
      processEscapes: true,
      processEnvironments: false,
      processRefs: false,
      skipTags: ['script','noscript','style','textarea','pre','code','a','h1','h2','h3','h4','h5','h6']
    }
   })</script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/gpt.js"></script><meta http-equiv="origin-trial" content="A2shzsdPO+RKe83bUqT9oVkYwGZN6j9O7nrcOASNFPuQz8HefgVYb9qAqn6coNCSDIRtXoi6ybCrjEsYh3caFgIAAAB7eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2MTM0OTU4NjgsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/pubads_impl_2021012601.js" async=""></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(7).txt"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(8).txt"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(9).txt"></script><link rel="preload" href="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(10).txt" as="script"><script type="text/javascript" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(10).txt"></script><link rel="preload" href="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(11).txt" as="script"><script type="text/javascript" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(11).txt"></script><link rel="prefetch" href="https://6ac0e69158f39093848c8f06ebb47534.safeframe.googlesyndication.com/safeframe/1-0-37/html/container.html"><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-37/html/container.html"><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(12).txt"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(13).txt"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(14).txt"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/f(15).txt"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/lift_widget.js"></script><style type="text/css">#logly-lift-4279493 #logly-lift-widget {
  
  width: 100%;
  
  
  
  clear: both;
}

#logly-lift-4279493 #logly-lift-widget-label {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  
  border-bottom-color: #5C97FF;
  
}

#logly-lift-4279493 #logly-lift-widget-label-caption {
  padding: 5px 10px;
  
  background-color: #5C97FF;
  
  float: left;
}

#logly-lift-4279493 #logly-lift-widget-label-caption a {
  
  color: #FFFFFF;
  
  
  text-decoration: none;
}

#logly-lift-4279493 .logly-lift-ad {
  display: inline-block;
  zoom: 1;
  vertical-align:top;
  
  width: 100%;
  
  margin: 5px 0;
  padding: 0;
}



#logly-lift-4279493 .logly-lift-ad-image {
  
  vertical-align: top;
  width: 120px;
  height: 90px;
  padding-right: 0;
}

#logly-lift-4279493 .logly-lift-ad-image-inner {
  position: relative;
  overflow: hidden;
  width: 120px;
  height: 90px;
}

#logly-lift-4279493 .logly-lift-ad-image-inner a {
  display: block;
  height: 100%;
}

#logly-lift-4279493 .logly-lift-ad-image-inner a .logly-lift-ad-img-inner {
  height: 100%;
  background-position: center;
  background-size: cover;
}

#logly-lift-4279493 .logly-lift-ad-content {
  
  word-break: break-all;
}



#logly-lift-4279493 .logly-lift-ad-title {
  
  
}



#logly-lift-4279493 .logly-lift-ad-lead {
  
  
}



#logly-lift-4279493 a.logly-lift-ad-site {
  
  
}





#logly-lift-4279493 .logly-lift-ad-disclosure {
  
  
  
  text-align: left;
  
}

#logly-lift-4279493 .logly-lift-ad-disclosure a {
  
  
  color: #999999;
  
}

#logly-lift-4279493 .logly-lift-clear {
  clear: both;
}



#logly-lift-4279493 .ie-lte9 .logly-lift-ad {
  display: inline;
}

#logly-lift-toaster .logly-lift-credit,
#logly-lift-4279493 .logly-lift-credit {
  clear:both;
  padding:0 8px 10px;
  text-align:right;
}

#logly-lift-toaster .logly-lift-credit {
  padding-right:0;
}

#logly-lift-toaster .logly-lift-credit a,
#logly-lift-4279493 .logly-lift-credit a {
  color: #999;
  text-decoration: none;
  font-size:13px;
}

#logly-lift-toaster .logly-lift-credit a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit a .logly-lift-credit-logo {
  display:inline-block;
  background: url("//cdn.logly.co.jp/spritesource-s5c12c753d2.png") no-repeat 0 -103px;
  color:transparent;
  margin-left:3px;
  width:36px;
  height:14px;
  vertical-align:middle;
  *display:inline;
  *zoom:1;
}

#logly-lift-toaster .logly-lift-credit a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit a:hover .logly-lift-credit-logo {
  background: url("//cdn.logly.co.jp/spritesource-s5c12c753d2.png") no-repeat 0 -117px;
}

#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-modal-contents-inner h3 {
  background-image: url('https://cdn.logly.co.jp/spritesource-s6c20d2e001.png');
  background-repeat: no-repeat;
}

#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
  background-position: 0 -110px;
  height: 14px;
  width: 68px;
}

#logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo {
  background-position: 0 -196px;
  height: 14px;
  width: 68px;
}
#logly-lift-modal-contents-inner h3 {
  background-position: 0 -232px;
  height: 40px;
  width: 194px;
}

#logly-lift-toaster .logly-lift-credit2 {
  padding-right: 0;
}
#logly-lift-toaster .logly-lift-credit2,
#logly-lift-4279493 .logly-lift-credit2 {
  clear: both;
  padding: 0 8px 10px;
  text-align: right;
}
#logly-lift-toaster .logly-lift-credit2 a,
#logly-lift-4279493 .logly-lift-credit2 a {
  color: #999;
  text-decoration: none;
  font-size: 11px;
}
#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
  display: inline-block;
  color: transparent;
  margin-left: 3px;
  vertical-align: middle;
  margin-top: -2px;
}
@media only screen and (-webkit-min-device-pixel-ratio: 2),
only screen and (min-device-pixel-ratio: 2),
(min-resolution: 2dppx) {
  #logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
  #logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
    display: inline-block;
    background-position: 0 -62px;
    height: 14px;
    width: 68px;
    background-size: 106px 136px;
  }
}
@media only screen and (-webkit-min-device-pixel-ratio: 2),
only screen and (min-device-pixel-ratio: 2),
(min-resolution: 2dppx) {
  #logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
  #logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo {
    display: inline-block;
    background-position: 0 -62px;
    height: 14px;
    width: 68px;
    background-size: 106px 136px;
  }
}

#logly-lift-4279493 .logly-lift-widget-video-content {
  padding: 20px;
  background: #fff;
}

#logly-lift-4279493 .logly-lift-video {
  width: auto;
  height: auto;
  margin: 0 -20px;
  position: relative;
  overflow: hidden;
  box-sizing: border-box;
  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.17);
}

#logly-lift-4279493 .logly-lift-video-header {
  padding-bottom: 15px;
}

#logly-lift-4279493 .logly-lift-video-footer {
  padding-top: 15px;
}

#logly-lift-4279493 .logly-lift-video-header .logly-lift-video-headerlink,
#logly-lift-4279493 .logly-lift-video-footer .logly-lift-video-footerlink {
  display: block;
  text-decoration: none;
}

#logly-lift-4279493 .logly-lift-video-header .logly-lift-video-headerlink::after,
#logly-lift-4279493 .logly-lift-video-footer .logly-lift-video-footerlink::after {
  content: "";
  display: block;
  clear:both;
}

#logly-lift-4279493 .logly-lift-video-title {
  font-size: 16px;
  line-height: 25px;
  font-weight: bold;
  margin-bottom: 8px;
  color: #333;
}

#logly-lift-4279493 .logly-lift-video-adv {
  font-size: 11px;
  line-height: 1;
  color: #CCC;
  text-align: right;
}

#logly-lift-4279493 .logly-lift-video-cv {
  display: block;
  text-align: center;
  background: #4285f4;
  color: #FFF;
  border-radius: 3px;
}

#logly-lift-4279493 .logly-lift-video-cv:hover {
  opacity: 0.85;
}

/* type-1 */
#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-title,
#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-header .logly-lift-video-adv {
  display: none;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-adv {
  text-align: left;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-cv {
  float: right;
  padding: 3px 20px;
  line-height: 1.8;
  font-size: 14px;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-cv::before {
  content: "詳細を見る";
}


  /*
---
name: Anonymous
category: LoglyFeed/Anonymous
---


To reflect this design, you must copy and paste it to https://www.logly.co.jp design settings


!![](LoglyFeed/Anonymous.html)

*/

#logly-lift-4279493 #logly-lift-widget-header {
  font-size: 16px;
  margin-bottom: 12px;
  font-weight: 400;
  font-feature-settings: "palt";
  position: relative;
}

#logly-lift-4279493 #logly-lift-widget-content {
  display: block;
  flex-wrap: wrap;
}

#logly-lift-4279493 .logly-lift-ad {
  display: flex;
  align-items: center;
  border-bottom: 1px solid #e8e8e8;
  margin: 0;
  padding: 16px;
}

#logly-lift-4279493 .logly-lift-ad:first-child {
  border-top: 1px solid #e8e8e8;
}

#logly-lift-4279493 .logly-lift-ad .fa {
  color: #55c500;
  font-size: 40px;
}

#logly-lift-4279493 .logly-lift-ad .fa-fw {
  width: 40px;
  height: 40px;
  text-align: left;
}

#logly-lift-4279493 .logly-lift-ad-icon {
  overflow: hidden;
  border-radius: 0.2em;
  width: 40px;
  height: 40px;
  flex-shrink: 0;
  margin-top: 2px;
}

#logly-lift-4279493 .logly-lift-ad-icon img {
  width: 100%;
  height: 100%;
}

#logly-lift-4279493 .logly-lift-ad-content {
  display: block;
}

#logly-lift-4279493 .logly-lift-ad-link {
  margin-right: 8px;
}

#logly-lift-4279493 .logly-lift-ad-title {
  display: inline-block;
  font-size: 1.6rem;
  font-weight: bold;
  color: #333;
  line-height: 1.4;
  margin-bottom: 4px;
  word-wrap: break-word;
  word-break: break-all;
  margin-left: 8px;
}

#logly-lift-4279493 .logly-lift-ad-title:visited {
  color: #777;
}

#logly-lift-4279493 .logly-lift-ad-link:hover .logly-lift-ad-title {
  text-decoration: underline;
}

#logly-lift-4279493 .logly-lift-ad-author {
  display: block;
  color: #999;
  margin-left: 8px;
  font-size: 0.9rem;
}

#logly-lift-4279493 .logly-lift-ad-adv {
  display: block;
  color: #999;
  margin-left: 8px;
  font-size: 0.9rem;
}



</style></head><body><iframe src="./HTML5 Canvas でドラッグ操作 - Qiita_files/sync.html" scrolling="no" style="display: none; border: none;"></iframe><div class="allWrapper"><div class="st-HeaderContainer"><div id="GlobalHeader-react-component-fdb356fe-2993-463b-ab43-e7bc5c47cc8c"><div class="st-Header"><div class="st-Header_container"><div class="st-Header_start"><a href="https://qiita.com/" class="st-Header_logo mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div><div class="st-Header_realmSelector" tabindex="0"><span class="fa fa-fw fa-caret-down"></span></div><div class="st-Header_dropdown st-RealmSelector"><div class="st-RealmSelector_realms"><a class="st-Header_dropdownItem st-RealmItem" href="https://qiita.com/"><div class="st-RealmItem_statusIcon"><span class="fa fa-fw fa-check"></span></div><div class="st-RealmItem_humanName">Qiita</div></a></div><hr><div class="st-RealmSelector_supplements"><div class="st-RealmSelector_label">ログイン中のチームがありません</div><a href="https://teams-center.qiita.com/find_team" class="st-Header_dropdownItem st-RealmSelectorSupplement"><div class="st-RealmSelectorSupplement_icon"><span class="fa fa-fw fa-sign-in"></span></div><div>Qiita Team にログイン...</div></a></div></div></div><div><div class="st-Header_community" tabindex="0">コミュニティ<span class="fa fa-fw fa-caret-down ml-1of2"></span></div><div class="st-Header_dropdown"><a href="https://qiita.com/organizations" class="st-Header_dropdownItem"><span class="fa fa-fw fa-building-o mr-1of2"></span>Organization一覧</a><a href="https://qiita.com/advent-calendar" class="st-Header_dropdownItem"><span class="fa fa-fw fa-calendar mr-1of2"></span>アドベントカレンダー</a><div class="st-Header_dropdownSeparator"></div><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank"><span class="fa fa-fw fa-search mr-1of2"></span>Qiita Jobs</a><a href="https://qiitadon.com/" class="st-Header_dropdownItem" target="_blank"><span class="fa fa-fw fa-comments-o mr-1of2"></span>Qiitadon (β)</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" class="st-Header_dropdownItem" target="_blank"><span class="fa fa-fw fa-newspaper-o mr-1of2"></span>Qiita Zine</a><div class="st-Header_dropdownSeparator"></div><a href="https://help.qiita.com/ja/articles/qiita-community-guideline" class="st-Header_dropdownItem" target="_blank"><span class="fa fa-fw fa-book mr-1of2"></span>コミュニティガイドライン</a><a href="https://help.qiita.com/ja/articles/qiita-article-guideline" class="st-Header_dropdownItem" target="_blank"><span class="fa fa-fw fa-book mr-1of2"></span>良い記事を書くために</a><a href="https://qiita.com/release-notes" class="st-Header_dropdownItem" target="_blank"><span class="fa fa-fw fa-book mr-1of2"></span>リリースノート</a></div></div><form class="st-Header_search" action="https://qiita.com/search" method="get"><span class="fa fa-search"></span><input type="search" class="st-Header_searchInput" autocomplete="off" placeholder="キーワードを入力" value="" name="q" required=""></form><div class="st-Header_searchButton"><span class="fa fa-search"></span></div></div><div class="st-Header_end"><a class="st-Header_signupButton" href="https://qiita.com/signup?redirect_to=%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596">ユーザー登録</a><a class="st-Header_loginLink" href="https://qiita.com/login?redirect_to=%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596">ログイン</a></div><div class="st-Header_overlay"></div><form class="st-Header_searchModal" action="https://qiita.com/search" method="get"><input type="text" class="st-Header_searchModalInput" autocomplete="off" placeholder="キーワードを入力" value="" name="q" required=""></form></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="GlobalHeader" data-dom-id="GlobalHeader-react-component-fdb356fe-2993-463b-ab43-e7bc5c47cc8c">{"unreadNotificationsCount":null,"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"teamFindUrl":"https://teams-center.qiita.com/find_team","isTeamOnlyUser":null,"currentUser":null}</script>
      
</div><div class="st-HeaderAlert st-HeaderAlert-warning"><div class="st-HeaderAlert_body"></div></div><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/javascript","name":"JavaScript"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2016-05-18T00:44:12.000+09:00","dateModified":"2016-05-18T00:44:12.000+09:00","headline":"HTML5 Canvas でドラッグ操作","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-1.2.2\u0026w=1200\u0026mark=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D380%26txt%3DHTML5%2520Canvas%2520%25E3%2581%25A7%25E3%2583%2589%25E3%2583%25A9%25E3%2583%2583%25E3%2582%25B0%25E6%2593%258D%25E4%25BD%259C%26txt-color%3D%2523333%26txt-font%3DHiragino%2520Sans%2520W6%26txt-size%3D54%26txt-clip%3Dellipsis%26txt-align%3Dcenter%252Cmiddle%26s%3D897dcab3d567504380ad5e9bdc53feaa\u0026mark-align=center%2Cmiddle\u0026blend=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D500%26txt%3D%2540kyrieleison%26txt-color%3D%2523333%26txt-font%3DHiragino%2520Sans%2520W6%26txt-size%3D45%26txt-align%3Dright%252Cbottom%26s%3D5263619810df56d5f919aaf288f04770\u0026blend-align=center%2Cmiddle\u0026blend-mode=normal\u0026s=64a1179481ca225f54f2927ca6398b4c","mainEntityOfPage":"https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596","author":{"@type":"Person","address":"Tokyo, Japan","email":null,"identifier":"kyrieleison","name":"kyrieleison","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F44003%2Fprofile-images%2F1537150852?ixlib=rb-1.2.2\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=6ba3e16efdefb8e998aeb36b7bc6ff59","url":"https://qiita.com/kyrieleison","description":"","memberOf":[{"@type":"Organization","address":"〒102-0093 東京都千代田区平河町2-5-3　Nagatacho GRID","legalName":"株式会社ガイアックス","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/393eef67cf6e4adccde53becedafd1fddfb63615/original.jpg?1504245096","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/646b13eb1e51a484163f320913d23a40d3f40fe1/original.jpg?1468893400","identifier":"gaiax","description":"人と人をつなげる　Empowering the people to connect."}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-green-36e6153054916b1d8ed7fc47163039da.png"}}}</script><script>td.trackEvent('pageviews_article',{
    user_id: "",
    article_id: "393207",
    article_uuid: "26fcfb3a1d94bc92c596",
    td_description: "&quot;以下の記事で HTML5 Canvas に入門しました。\nhttp://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0\n\nが、どうせなら描画した要素をドラッグでぐりぐり動かすくらいは、やってみたいところです。\nやってみました。\n\nコードだけ見たい方はこちらを。\nhttps://github.com/kyrieleison/canvas-dragging-tutorial/blob/master/index.html\n\n# キャンバスを準備する\n```\n\u0026amp;lt;!DOCTYPE html\u0026amp;gt;\n\u0026amp;lt;html\u0026amp;gt;\n  \u0026amp;lt;head\u0026amp;gt;\n    \u0026amp;lt;title\u0026amp;gt;canvas tutorial\u0026amp;lt;/title\u0026amp;gt;\n    \u0026amp;lt;style\u0026amp;gt;\n      #canvas {\n        background: #666;\n      }\n    \u0026amp;lt;/style\u0026amp;gt;\n  \u0026amp;lt;/head\u0026amp;gt;\n  \u0026amp;lt;body\u0026amp;gt;\n    \u0026amp;lt;canvas id=\u0026amp;quot;canvas\u0026amp;quot; width=\u0026amp;quot;640\u0026amp;quot; height=\u0026amp;quot;480\u0026amp;quot;\u0026amp;gt;\u0026amp;lt;/canvas\u0026amp;gt;\n    \u0026amp;lt;script\u0026amp;gt;\n      // ここにコードを書いていきます\n    \u0026amp;lt;/script\u0026amp;gt;\n  \u0026amp;lt;/body\u0026amp;gt;\n\u0026amp;lt;/html\u0026amp;gt;\n```\n\nまずは HTML の雛形です。\n\n# ドラッグで動かすオブジェクトを初期表示する\n```\nvar canvas = document.getElementById(\u0026amp;quot;canvas\u0026amp;quot;);\nvar context = canvas.getContext(\u0026amp;#39;2d\u0026amp;#39;);\nvar objX, objY;\nvar objWidth, objHeight;\n\nfunction init() {\n  // オブジェクトの大きさを定義\n  objWidth = 50;\n  objHeight = 50;\n\n  // オブジェクトの座標を定義(キャンバスの中央に表示)\n  objX = canvas.width / 2 - objWidth / 2;\n  objY = canvas.height / 2 - objHeight / 2;\n\n  // オブジェクトを描画\n  drawRect();\n}\n\nfunction drawRect() {\n  context.fillRect(objX, objY, objWidth, objHeight);\n}\n```\n\nまずはドラッグで動かす対象となるオブジェクトを表示します。\n今回は縦50px X 横50px のシンプルな正方形をキャンバスの中央に表示する `init()` 関数を定義します。\n\n```\n\u0026amp;lt;body onLoad=\u0026amp;quot;init()\u0026amp;quot;\u0026amp;gt;\n  \u0026amp;lt;canvas id=\u0026amp;quot;canvas\u0026amp;quot; width=\u0026amp;quot;640\u0026amp;quot; height=\u0026amp;quot;480\u0026amp;quot;\u0026amp;gt;\u0026amp;lt;/canvas\u0026amp;gt;\n  \u0026amp;lt;script\u0026amp;gt;\n    ...\n  \u0026amp;lt;/script\u0026amp;gt;\n\u0026amp;lt;/body\u0026amp;gt;\n```\n\nそして `body` タグで雑な感じに `init()` 関数を実行するようにします。\nこれでキャンバスにオブジェクトが表示されるようになりました。\n\n# マウス座標を取得し、オブジェクトかどうかを判定する\n```\nvar x, y, relX, relY;\nvar dragging = false;\n\nfunction onDown(e) {\n  // キャンバスの左上端の座標を取得\n  var offsetX = canvas.getBoundingClientRect().left;\n  var offsetY = canvas.getBoundingClientRect().top;\n\n  // マウスが押された座標を取得\n  x = e.clientX - offsetX;\n  y = e.clientY - offsetY;\n\n  // オブジェクト上の座標かどうかを判定\n  if (objX \u0026amp;lt; x \u0026amp;amp;\u0026amp;amp; (objX + objWidth) \u0026amp;gt; x \u0026amp;amp;\u0026amp;amp; objY \u0026amp;lt; y \u0026amp;amp;\u0026amp;amp; (objY + objHeight) \u0026amp;gt; y) {\n    dragging = true; // ドラッグ開始\n    relX = objX - x;\n    relY = objY - y;\n  }\n}\n\ncanvas.addEventListener(\u0026amp;#39;mousedown\u0026amp;#39;, onDown, false);\n```\n\n次に、マウスの左ボタンが押されたときに、それがオブジェクト上なのかどうかを判定します。\n押されたのがオブジェクト上であればドラッグ開始(`dragging = true`)と見なし、オブジェクト上でなければ何もしません。\n\nマウスが押された座標を取得するためには、`canvas.getBoundingClientRect()` メソッドで画面上でのキャンバスの座標を取得します。\n`clientX/Y` プロパティで取得した画面上の座標から、キャンバス座標を減算することでキャンバス内の相対位置を取得できます。\n\n座標は常にオブジェクトの左上を指し、右あるいは下に行くほど大きな値となるため、オブジェクト上の座標かどうかは以下のような判定条件になります。\n\n- `objX \u0026amp;lt; x`: オブジェクトの左端よりも右で押された場合\n- `(objX + objWidth) \u0026amp;gt; x`: オブジェクトの右端よりも左で押された場合\n- `objY \u0026amp;lt; y`: オブジェクトの上端よりも下で押された場合\n- `(objY + objHeight) \u0026amp;gt; x`: オブジェクトの下端よりも上で押された場合\n\nこれらの判定条件をクリアすると**オブジェクトの上でドラッグが開始された**とみなすことができるので、`dragging` フラグを `true` にします。\nまた、オブジェクトとマウス座標との差分を `relX/Y` に格納しておきます。\n\n# ドラッグでオブジェクトを移動する\n```\nfunction onMove(e) {\n  // キャンバスの左上端の座標を取得\n  var offsetX = canvas.getBoundingClientRect().left;\n  var offsetY = canvas.getBoundingClientRect().top;\n\n  // マウスが移動した先の座標を取得\n  x = e.clientX - offsetX;\n  y = e.clientY - offsetY;\n\n  // ドラッグが開始されていればオブジェクトの座標を更新して再描画\n  if (dragging) {\n    objX = x + relX;\n    objY = y + relY;\n    drawRect();\n  }\n}\n\nfunction onUp(e) {\n  dragging = false; // ドラッグ終了\n}\n\nfunction drawRect() {\n  context.clearRect(0, 0, canvas.width, canvas.height); // キャンバスをクリア\n  context.fillRect(objX, objY, objWidth, objHeight);\n}\n\ncanvas.addEventListener(\u0026amp;#39;mousemove\u0026amp;#39;, onMove, false);\ncanvas.addEventListener(\u0026amp;#39;mouseup\u0026amp;#39;, onUp, false);\n```\n\nキャンバス上をドラッグしてオブジェクトを移動するには、**今描画しているオブジェクトを消去して、次のマウス座標上にオブジェクトを再描画する**ということをします。\n\nマウス移動を常に監視し、オブジェクト上でドラッグが開始していればその移動先のマウス座標でオブジェクトを描画します。\nそして、マウスの左ボタンが離されたらドラッグを終了と見なします。\n\nこのときに、前の位置のオブジェクトがキャンバス上に残り続けてしまうため、`context.clearRect()` メソッドで描画する度にキャンバス全体をクリアします。\n\nこれでキャンバス上でのドラッグ移動ができました。\n\n---\n\n今回は以下の記事やコードを参考にさせていただきました。\nhttp://rika.edu.gunma-u.ac.jp/~terasima/junk/ex07.html\nhttp://lab.ve-lo.net/?p=312\nhttp://qiita.com/akase244/items/b801f435e85ea67a70eb\n\nただ、この実装では複数のオブジェクトが描画されたときに、ドラッグする度に他のオブジェクトもクリアされてしまいます。\nオブジェクトが長方形でないと判定の仕方も変わりますし、オブジェクトの重ね順についても考慮されていません。\n\n通常の DOM 要素であれば HTML5 Drag \u0026amp;amp; Drop API で比較的簡単に実装できるようですが、キャンバスだと座標計算をごりごりするコードになりそうです。\nユーザに描画をさせるような機能であれば別ですが、単にドラッグアンドドロップを実現するのであれば、キャンバスは避けた方がいいかもしれませんね。\n&quot;",
    td_title: "&quot;HTML5 Canvas でドラッグ操作&quot;"
  })</script><style type="text/css">.wb-CampaignLink {
  background-color: #333333;
  width: 100%;
}

.wb-CampaignLink_container {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1100px;
  margin: 0 auto;
  font-size: 13px;
  padding: 0.8em;
}
.wb-CampaignLink_container > a {
  color: #fff;
}

.wb-CampaignLink_container > a:hover {
  text-decoration: underline;
}</style><div class="wb-CampaignLink"><div class="wb-CampaignLink_container"><a target="_blank" id="header_text_message_1" href="https://zine.qiita.com/products/202010-wvd-3/?utm_source=qiita&amp;utm_medium=header-banner">WVDのディープな技術情報を解説 | 多要素認証と条件付きアクセス</a><a target="_blank" id="header_text_message_2" href="https://zine.qiita.com/products/202010-wvd-3/?utm_source=qiita&amp;utm_medium=header-banner">詳しくはこちら</a></div><script>td.trackEvent(
  'front_events',
  {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kyrieleison","type":"items","id":"26fcfb3a1d94bc92c596"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Show","data":{"message":"WVDのディープな技術情報を解説 | 多要素認証と条件付きアクセス","url":"https://zine.qiita.com/products/202010-wvd-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
)</script><script>document.getElementById('header_text_message_1').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kyrieleison","type":"items","id":"26fcfb3a1d94bc92c596"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_1","message":"WVDのディープな技術情報を解説 | 多要素認証と条件付きアクセス","url":"https://zine.qiita.com/products/202010-wvd-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script><script>document.getElementById('header_text_message_2').addEventListener('click', function() {
  td.trackEvent(
    'front_events',
    {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"kyrieleison","type":"items","id":"26fcfb3a1d94bc92c596"},"user_id":null,"event_category":"Header Text Ads Banner","event_action":"Click","data":{"index":0,"pos_id":"header_text_message_2","message":"WVDのディープな技術情報を解説 | 多要素認証と条件付きアクセス","url":"https://zine.qiita.com/products/202010-wvd-3/?utm_source=qiita\u0026utm_medium=header-banner","sub_message":"詳しくはこちら"}}
  )
})</script></div><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/qiita_bigmining.js"></script><div style="display:none"><div class="TagList__label"><span></span><span>JavaScript</span></div><div class="TagList__label"><span></span><span>HTML5</span></div><div class="TagList__label"><span></span><span>canvas</span></div><div class="TagList__label"><span></span><span>入門</span></div></div><img style="display:block;margin:0;padding:0;border:0;outline:0;width:0;height:0;line-height:0;" alt="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/bizmatrix"><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"ja","i18nDefaultLocale":"en","href":"https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596","location":"/kyrieleison/items/26fcfb3a1d94bc92c596","scheme":"https","host":"qiita.com","port":null,"pathname":"/kyrieleison/items/26fcfb3a1d94bc92c596","search":null,"httpAcceptLanguage":"ja,en-US;q=0.9,en;q=0.8","actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"un5pOrLQUC+yTs0dKiQzRF5IatExy1OwMAxIWb3tBocI0pIgFPlZN8d6h7l3N3lM5RM7HV0F3nSNALweJ8gBZQ==","locale":"ja"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-ac38a70c-7772-494f-9f70-a4846208032b"><div class="p-items"><div class="p-items_wrapper"><div class="p-items_container"><div class="it-Actions p-items_stickyMenu"><div class="it-Actions_item it-Actions_item-like likable"><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596/likers" class="it-Actions_likeCount">48</a><button title="Looks Good To Me!" class=""><svg size="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="#55C500" class="css-i8j2lc e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></button></div><div class="it-Actions_item"><button title="ストック" class=" css-4x6mse efxk0aq0"><span class="css-1dgwthh efxk0aq1"><svg size="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" class="css-f4pswy e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></span></button></div><a class="it-Actions_jumpToCommentButton" href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#comments"><div class="it-Actions_commentCount">0</div><div class="fa fa-fw fa-comment"></div></a><div class="it-Actions_shareButton it-Actions_shareButton-twitter"><span class="fa fa-twitter"></span></div><div class="it-Actions_shareButton it-Actions_shareButton-facebook"><span class="fa fa-facebook"></span></div></div><div class="p-items_main"><div class="p-items_article"><div class="it-Header"><div class="u-flex-center-between mb-3"><div class="it-Header_info"><div class="it-Header_author"><a href="https://qiita.com/kyrieleison"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/https___qiita-image-store.s3.amazonaws.com_0_44003_profile-images_1537150852" alt="kyrieleison" class="it-Header_authorImage"></a><a href="https://qiita.com/kyrieleison" class="it-Header_authorName">@<!-- -->kyrieleison</a></div><div class="it-Header_time"><time datetime="2016-05-17T15:44:12Z">2016年05月18日</time></div><div class="it-Header_meta"><div class="it-Header_manipulate"><div class="it-Header_dropdown"><span class="it-Header_dropdownToggle" tabindex="0"><span class="fa fa-ellipsis-h fa-lg"></span></span><div class="css-1lpnfiw"><div><div class="css-1gj7nt">記事の改善</div><a href="https://qiita.com/drafts/26fcfb3a1d94bc92c596/edit" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-code-fork css-1jqivyb" aria-hidden="true"></i></span>編集リクエストを送る</a><div class="css-1ode1bp"></div></div><div class="css-1gj7nt">記事の改善</div><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596/revisions" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-history css-1jqivyb" aria-hidden="true"></i></span>編集履歴</a><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596/patches" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-inbox css-1jqivyb" aria-hidden="true"></i></span>編集リクエスト一覧</a><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596/likers" class="css-154zy0m"><span class="css-yikrym"><svg size="13" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 392.81 429" color="rgba(0, 0, 0, 0.6)" class="css-le4d8r e31pr5q0"><path d="M14.19 5.4h53.86v149.45h90.05v44.87H14.19zM288.4 93.77h100.79q1.29 25-5.66 45.39a96.79 96.79 0 01-20.33 34.89 92 92 0 01-32.13 22.45 104 104 0 01-40.95 7.93 109.71 109.71 0 01-76-29.92 104.05 104.05 0 01-23-32.56 95.46 95.46 0 01-8.47-39.88 94.78 94.78 0 018.47-39.87 104.38 104.38 0 0123-32.42A107.71 107.71 0 01248.23 8a110.79 110.79 0 01118.48 22.49l-35.07 35.08a51.25 51.25 0 00-17.75-15 52.83 52.83 0 00-44.67-1.23 52.92 52.92 0 00-17 12 57.07 57.07 0 00-11.45 18.11 60 60 0 00-4.23 22.77 60 60 0 004.23 22.68 56.57 56.57 0 0011.45 18.19 52.62 52.62 0 0017 12 50.5 50.5 0 0020.9 4.36q20.19 0 31.07-7.51a35.75 35.75 0 0014.46-20.55h-47.39zM51.29 279.55H0v-44.86h156v44.86h-51.13V429H51.29zM283.36 381.71l-41.72-62V429h-53.86V234.69h47.47L290 312l55.9-77.29h46.9V429h-53.86V320.27l-42.43 61.44z"></path></svg></span>LGTMしたユーザー一覧</a><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596.md" class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-file-text-o css-1jqivyb" aria-hidden="true"></i></span>Markdown で本文を見る</a><div class="css-1ode1bp"></div><div class="css-154zy0m"><span class="css-yikrym"><i class="fa fa-flag css-1jqivyb" aria-hidden="true"></i></span>問題がある記事を報告する</div></div></div></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">この記事にどのような問題がありますか？</span></div><div class="st-Form"><label><input type="radio" name="reason" value="illegal" required="">法律違反（著作権侵害、プライバシー侵害、名誉棄損等）</label></div><div class="st-Form"><label><input type="radio" name="reason" value="inappropriate_content" required="">社会的に不適切（公序良俗に反する）</label></div><div class="st-Form"><label><input type="radio" name="reason" value="advertising" required="">宣伝行為</label></div><div class="st-Form"><label><input type="radio" name="reason" value="spam" required="">スパムの疑い</label></div><div class="st-Form"><label><input type="radio" name="reason" value="guideline_violation" required="">上記以外だが、Qiitaのコミュニティにふさわしくない（ガイドライン違反）</label></div><div class="st-Form st-Form-right"><input type="submit" class="st-Form_submit" value="送信"></div></form></div></div></div></div></div><h1 class="it-Header_title">HTML5 Canvas でドラッグ操作</h1><div class="it-Tags"><a href="https://qiita.com/tags/javascript" class="it-Tags_item"><span>JavaScript</span></a><a href="https://qiita.com/tags/html5" class="it-Tags_item"><span>HTML5</span></a><a href="https://qiita.com/tags/canvas" class="it-Tags_item"><span>canvas</span></a><a href="https://qiita.com/tags/%e5%85%a5%e9%96%80" class="it-Tags_item"><span>入門</span></a></div></div><div class="it-DeprecationAlert_three mb-5 p-2"><span class="fa fa-warning mr-1"></span>この記事は最終更新日から3年以上が経過しています。</div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>以下の記事で HTML5 Canvas に入門しました。<br>
<a href="http://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0" class="autolink" id="reference-c53464189999dbb4a9d0">http://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0</a></p>

<p>が、どうせなら描画した要素をドラッグでぐりぐり動かすくらいは、やってみたいところです。<br>
やってみました。</p>

<p>コードだけ見たい方はこちらを。<br>
<a href="https://github.com/kyrieleison/canvas-dragging-tutorial/blob/master/index.html" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/kyrieleison/canvas-dragging-tutorial/blob/master/index.html</a></p>

<h1>
<span id="キャンバスを準備する" class="fragment"></span><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%92%E6%BA%96%E5%82%99%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>キャンバスを準備する</h1>

<div class="code-frame" data-lang="text"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;canvas tutorial&lt;/title&gt;
    &lt;style&gt;
      #canvas {
        background: #666;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id="canvas" width="640" height="480"&gt;&lt;/canvas&gt;
    &lt;script&gt;
      // ここにコードを書いていきます
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></div></div>

<p>まずは HTML の雛形です。</p>

<h1>
<span id="ドラッグで動かすオブジェクトを初期表示する" class="fragment"></span><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%88%9D%E6%9C%9F%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ドラッグで動かすオブジェクトを初期表示する</h1>

<div class="code-frame" data-lang="text"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre>var canvas = document.getElementById("canvas");
var context = canvas.getContext('2d');
var objX, objY;
var objWidth, objHeight;

function init() {
  // オブジェクトの大きさを定義
  objWidth = 50;
  objHeight = 50;

  // オブジェクトの座標を定義(キャンバスの中央に表示)
  objX = canvas.width / 2 - objWidth / 2;
  objY = canvas.height / 2 - objHeight / 2;

  // オブジェクトを描画
  drawRect();
}

function drawRect() {
  context.fillRect(objX, objY, objWidth, objHeight);
}
</pre></div></div>

<p>まずはドラッグで動かす対象となるオブジェクトを表示します。<br>
今回は縦50px X 横50px のシンプルな正方形をキャンバスの中央に表示する <code>init()</code> 関数を定義します。</p>

<div class="code-frame" data-lang="text"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre>&lt;body onLoad="init()"&gt;
  &lt;canvas id="canvas" width="640" height="480"&gt;&lt;/canvas&gt;
  &lt;script&gt;
    ...
  &lt;/script&gt;
&lt;/body&gt;
</pre></div></div>

<p>そして <code>body</code> タグで雑な感じに <code>init()</code> 関数を実行するようにします。<br>
これでキャンバスにオブジェクトが表示されるようになりました。</p>

<h1>
<span id="マウス座標を取得しオブジェクトかどうかを判定する" class="fragment"></span><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%83%9E%E3%82%A6%E3%82%B9%E5%BA%A7%E6%A8%99%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>マウス座標を取得し、オブジェクトかどうかを判定する</h1>

<div class="code-frame" data-lang="text"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre>var x, y, relX, relY;
var dragging = false;

function onDown(e) {
  // キャンバスの左上端の座標を取得
  var offsetX = canvas.getBoundingClientRect().left;
  var offsetY = canvas.getBoundingClientRect().top;

  // マウスが押された座標を取得
  x = e.clientX - offsetX;
  y = e.clientY - offsetY;

  // オブジェクト上の座標かどうかを判定
  if (objX &lt; x &amp;&amp; (objX + objWidth) &gt; x &amp;&amp; objY &lt; y &amp;&amp; (objY + objHeight) &gt; y) {
    dragging = true; // ドラッグ開始
    relX = objX - x;
    relY = objY - y;
  }
}

canvas.addEventListener('mousedown', onDown, false);
</pre></div></div>

<p>次に、マウスの左ボタンが押されたときに、それがオブジェクト上なのかどうかを判定します。<br>
押されたのがオブジェクト上であればドラッグ開始(<code>dragging = true</code>)と見なし、オブジェクト上でなければ何もしません。</p>

<p>マウスが押された座標を取得するためには、<code>canvas.getBoundingClientRect()</code> メソッドで画面上でのキャンバスの座標を取得します。<br>
<code>clientX/Y</code> プロパティで取得した画面上の座標から、キャンバス座標を減算することでキャンバス内の相対位置を取得できます。</p>

<p>座標は常にオブジェクトの左上を指し、右あるいは下に行くほど大きな値となるため、オブジェクト上の座標かどうかは以下のような判定条件になります。</p>

<ul>
<li>
<code>objX &lt; x</code>: オブジェクトの左端よりも右で押された場合</li>
<li>
<code>(objX + objWidth) &gt; x</code>: オブジェクトの右端よりも左で押された場合</li>
<li>
<code>objY &lt; y</code>: オブジェクトの上端よりも下で押された場合</li>
<li>
<code>(objY + objHeight) &gt; x</code>: オブジェクトの下端よりも上で押された場合</li>
</ul>

<p>これらの判定条件をクリアすると<strong>オブジェクトの上でドラッグが開始された</strong>とみなすことができるので、<code>dragging</code> フラグを <code>true</code> にします。<br>
また、オブジェクトとマウス座標との差分を <code>relX/Y</code> に格納しておきます。</p>

<h1>
<span id="ドラッグでオブジェクトを移動する" class="fragment"></span><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E7%A7%BB%E5%8B%95%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ドラッグでオブジェクトを移動する</h1>

<div class="code-frame" data-lang="text"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre>function onMove(e) {
  // キャンバスの左上端の座標を取得
  var offsetX = canvas.getBoundingClientRect().left;
  var offsetY = canvas.getBoundingClientRect().top;

  // マウスが移動した先の座標を取得
  x = e.clientX - offsetX;
  y = e.clientY - offsetY;

  // ドラッグが開始されていればオブジェクトの座標を更新して再描画
  if (dragging) {
    objX = x + relX;
    objY = y + relY;
    drawRect();
  }
}

function onUp(e) {
  dragging = false; // ドラッグ終了
}

function drawRect() {
  context.clearRect(0, 0, canvas.width, canvas.height); // キャンバスをクリア
  context.fillRect(objX, objY, objWidth, objHeight);
}

canvas.addEventListener('mousemove', onMove, false);
canvas.addEventListener('mouseup', onUp, false);
</pre></div></div>

<p>キャンバス上をドラッグしてオブジェクトを移動するには、<strong>今描画しているオブジェクトを消去して、次のマウス座標上にオブジェクトを再描画する</strong>ということをします。</p>

<p>マウス移動を常に監視し、オブジェクト上でドラッグが開始していればその移動先のマウス座標でオブジェクトを描画します。<br>
そして、マウスの左ボタンが離されたらドラッグを終了と見なします。</p>

<p>このときに、前の位置のオブジェクトがキャンバス上に残り続けてしまうため、<code>context.clearRect()</code> メソッドで描画する度にキャンバス全体をクリアします。</p>

<p>これでキャンバス上でのドラッグ移動ができました。</p>

<hr>

<p>今回は以下の記事やコードを参考にさせていただきました。<br>
<a href="http://rika.edu.gunma-u.ac.jp/~terasima/junk/ex07.html" class="autolink" rel="nofollow noopener" target="_blank">http://rika.edu.gunma-u.ac.jp/~terasima/junk/ex07.html</a><br>
<a href="http://lab.ve-lo.net/?p=312" class="autolink" rel="nofollow noopener" target="_blank">http://lab.ve-lo.net/?p=312</a><br>
<a href="http://qiita.com/akase244/items/b801f435e85ea67a70eb" class="autolink" id="reference-b4989f13b30be6b7a5d1">http://qiita.com/akase244/items/b801f435e85ea67a70eb</a></p>

<p>ただ、この実装では複数のオブジェクトが描画されたときに、ドラッグする度に他のオブジェクトもクリアされてしまいます。<br>
オブジェクトが長方形でないと判定の仕方も変わりますし、オブジェクトの重ね順についても考慮されていません。</p>

<p>通常の DOM 要素であれば HTML5 Drag &amp; Drop API で比較的簡単に実装できるようですが、キャンバスだと座標計算をごりごりするコードになりそうです。<br>
ユーザに描画をさせるような機能であれば別ですが、単にドラッグアンドドロップを実現するのであれば、キャンバスは避けた方がいいかもしれませんね。</p>
</div></div></section><div class="it-Footer"><div class="it-Footer_actions"><div class="it-Footer_editRequest"><a href="https://qiita.com/drafts/26fcfb3a1d94bc92c596/edit" class="u-link-no-underline"><span>編集リクエスト</span></a></div><div class="it-Footer_stock"><button><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" class="css-ah51ux e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg><span class="it-Footer_stockLabel">ストック</span></button></div><div class="it-Footer_like" title="Looks Good To Me!"><button style="background-color:#fff"><span style="width:100%;height:100%;display:flex;align-items:center;justify-content:center"><svg size="56" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 564.81 145.68" color="#55C500" class="css-4lkrad ezzk7cf0"><path d="M0 3.85h38.39v106.5h64.16v32H0zM195.41 66.82h71.82q.91 17.84-4 32.35A68.89 68.89 0 01248.71 124a65.49 65.49 0 01-22.9 16 74.08 74.08 0 01-29.17 5.65 78.16 78.16 0 01-54.17-21.32 74.1 74.1 0 01-16.42-23.21 68.08 68.08 0 01-6-28.41 67.7 67.7 0 016-28.42 74.44 74.44 0 0116.42-23.1 76.37 76.37 0 0124.32-15.52 78.92 78.92 0 0184.43 16.06l-25 25A36.52 36.52 0 00213.57 36a37.65 37.65 0 00-31.83-.87 37.7 37.7 0 00-12.08 8.57 40.75 40.75 0 00-8.17 12.91 42.8 42.8 0 00-3 16.22 42.91 42.91 0 003 16.17 40.44 40.44 0 008.17 13 37.4 37.4 0 0012.08 8.57 36.07 36.07 0 0014.9 3.11q14.38 0 22.13-5.35a25.46 25.46 0 0010.31-14.65h-33.77zM319.44 36.21h-36.55v-32h111.18v32h-36.45v106.5h-38.18zM486.82 109l-29.73-44.18v77.89H418.7V4.24h33.83l39 55.09 39.86-55.09h33.42v138.47h-38.38V65.23L496.19 109z"></path></svg></span></button><a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596/likers" class="it-Footer_likeCount">48</a></div></div><div class="it-Footer_social"><div class="it-Footer_shareButton it-Footer_shareButton-twitter"><span class="fa fa-twitter"></span></div><div class="it-Footer_shareButton it-Footer_shareButton-facebook"><span class="fa fa-facebook"></span></div></div></div><div class="ai-Container"><div class="ai-User"><a href="https://qiita.com/kyrieleison"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/https___qiita-image-store.s3.amazonaws(1).com_0_44003_profile-images_1537150852" alt="kyrieleison" class="ai-User_image"></a><div class="ai-User_body"><div class="ai-User_header"><a href="https://qiita.com/kyrieleison" class="ai-User_name">Yuka Tsuboi</a><a href="https://qiita.com/kyrieleison" class="ai-User_urlname">@<!-- -->kyrieleison</a><span itemscope="" itemtype="http://schema.org/Organization"><a href="https://qiita.com/organizations/gaiax"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/original.jpg" alt="gaiax" class="ai-User_organization"></a></span></div><div class="ai-User_description"></div><div class="ai-User_footer"><button class="css-1u064zm e7r9vc50">フォロー</button></div></div></div><div class="ai-Organization" itemscope="" itemtype="http://schema.org/Organization"><a href="https://qiita.com/organizations/gaiax"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/original.jpg" alt="gaiax" class="ai-Organization_image"></a><div class="ai-Organization_body"><div class="ai-Organization_header"><a href="https://qiita.com/organizations/gaiax" class="ai-Organization_name"><span>株式会社ガイアックス</span></a></div><div class="ai-Organization_description">人と人をつなげる　Empowering the people to connect.</div><a href="http://www.gaiax.co.jp/" class="ai-Organization_website">http://www.gaiax.co.jp/</a></div></div></div><div class="apm-Content"><div class="apm-Content_title">ユーザー登録して、Qiitaをもっと便利に使ってみませんか。</div><ol class="apm-Content_list"><li>あなたにマッチした記事をお届けします<div class="description">ユーザーやタグをフォローすることで、あなたが興味を持つ技術分野の情報をまとめてキャッチアップできます</div></li><li>便利な情報をあとで効率的に読み返せます<div class="description">気に入った記事を「ストック」することで、あとからすぐに検索できます</div></li><div><a class="apm-Content_help" href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank"><i class="fa fa-fw fa-arrow-circle-right"></i>より詳しく</a></div></ol><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596&amp;realm=qiita" class="apm-Content_button apm-Content_button-signup">登録する</a><a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596&amp;realm=qiita" class="apm-Content_button apm-Content_button-signin">ログインする</a></div><div><div class="it-Ads_afterBodyContainer it-Ads_afterBodyContainer-narrow"><div class="it-Ads_afterBodyWrapper"><div id="dfp-slot-article-after-body-for-mobile" class="ad-336x280" data-test-adunitpath="/383564218/qiita.com_items-show_under-article-mobile" elementtiming="gpt-dfp-slot-article-after-body-for-mobile" data-testid="ArticleAdsAfterBody_AdUnit" data-google-query-id="COOfmeXRvu4CFZO5vAod5WYD5Q"><div id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0__container__" style="border: 0pt none; display: inline-block; width: 336px; height: 280px;"><iframe frameborder="0" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/container.html" id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="336" height="280" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div></div></div></div></div></div><div class="p-items_options"><div class="mt-2"><div id="dfp-slot-article-sidebar-top" class="ad-300x250" data-test-adunitpath="/383564218/qiita.com_items-show_sidebar-top" elementtiming="gpt-dfp-slot-article-sidebar-top" data-testid="ArticleAdsSidebarTop_AdUnit" data-google-query-id="CK6ut-XRvu4CFQiXvAod6hoMVw"><div id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0__container__" style="border: 0pt none; display: inline-block; width: 300px; height: 250px;"><iframe frameborder="0" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/container(1).html" id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="300" height="250" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="2" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div></div></div><div class="p-items_toc"><div class="mt-2"><div id="dfp-slot-article-sidebar-bottom" class="ad-300x250" data-test-adunitpath="/383564218/qiita.com_items-show_sidebar-bottom" elementtiming="gpt-dfp-slot-article-sidebar-bottom" data-testid="ArticleAdsSidebarBottom_AdUnit" data-google-query-id="CKCcpeXRvu4CFRTyvAodvEcAKg"><div id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0__container__" style="border: 0pt none; display: inline-block; width: 300px; height: 250px;"><iframe frameborder="0" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/container(2).html" id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="300" height="250" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="3" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div></div><div class="it-Toc"><div class="it-Toc_nav"><ul>
<li>
<a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%92%E6%BA%96%E5%82%99%E3%81%99%E3%82%8B" class="">キャンバスを準備する</a>
</li>
<li>
<a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%88%9D%E6%9C%9F%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B" class="">ドラッグで動かすオブジェクトを初期表示する</a>
</li>
<li>
<a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%83%9E%E3%82%A6%E3%82%B9%E5%BA%A7%E6%A8%99%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B" class="">マウス座標を取得し、オブジェクトかどうかを判定する</a>
</li>
<li>
<a href="https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E7%A7%BB%E5%8B%95%E3%81%99%E3%82%8B" class="focus">ドラッグでオブジェクトを移動する</a>
</li>
</ul>
</div></div></div></div></div><div class="p-items_wrapper p-items_wrapper-white"><div class="p-items_container"><div class="p-items_leftDummy"></div><div class="p-items_main"><div class="p-items_aside mt-5 px-5 p-2@s"><div id="logly-lift-4279493"><div id="logly-lift-widget">  <div id="logly-lift-widget-header">    <span>関連記事</span>    <span class="logly-lift-credit logly-lift-credit2"><a href="https://www.logly.co.jp/privacy.html" target="_top" rel="nofollow noopener">Recommended by <span class="logly-lift-credit-logo" title="logly"></span></a></span>  </div>  <div id="logly-lift-widget-content">    <div class="logly-lift-ad">  <span class="logly-lift-ad-icon"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/ff1a6eafacf23564389fd14f1b6c629f" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-TDWpYiLT8jDCXsQN1kML2FDPX49L4txmq3PCOd7dHtIONLu48paIHu915upy_vZlVzYRwAqg2A8eKgQACRBjpudiJEhR4vkJ0yUQzkB59Iwo-jM_bo5t5VdjLEy6A1hDNn6xLUHJ7Mhs3HFNbuBwjnLtwTwVmn1zZy4UY7wWjX4XfXDqp4Ve2xA_e5Ynv61rvPAcW93t1wZIZQQappzzZZmGxNRKT4OxBmQB3wcsXsnmNTCRuuSr9EABHZ32MZdn7Xv_7CRZFR0qt72qSiapAK2VV0jTVy5bJaoh0ExOtL4DNLOfiKwR7XXVK9zIywT1huww6jj9fi8Qf257oUf7VlLPlpup96g6VabjxyF92a9l4Pa5PY9d00qd2V4jqrlc64HXpTXIJN6N_TxIkWX78EBKBS7_0ANvvGCyrmSP43DHc6qGtCbbUg6eus-Tbqup8UkDES5a6mYl3DNjcUG-0XPAhJ9_DpqfIrpLGMXaRCfEdUpRPa9IY_pxetbqDiM0kWjojEuhrvwfPhGJ1kAnHvGuuY2nf9VgoyM990d-hX3x9cYCIdWmdwFqhD6b4N-Ew" onmousedown="this.setAttribute(&#39;href&#39;,this.getAttribute(&#39;data-click-url&#39;));">      <span class="logly-lift-ad-title">HTML5 Canvas 入門</span>    </a>    <span class="logly-lift-ad-author">by kyrieleison</span><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/abc" width="1" height="1" style="position: absolute; width: 1px; height: 1px; top: -32767px; left: -32767px;" alt="">  </div　class="logly-lift-ad-content"></div></div><div class="logly-lift-ad">  <span class="logly-lift-ad-icon"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/ff4eee700158526eace55e733d2c11a4" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/takata182/items/18a1619a4bca3b9bb32a" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-TDWpYiLT8jDCXsQN1kML2FDPX49L4txmpeom7qZfc0RWBzgK7_npWlGijoJNxabkql-frrZ9j8WHjwPROC-sLGmas6Q_hvEs27tnX9LrSZP40H2f5Nouw-m5PJ4h0AW2zBE_LBGlLGGg2X_zQh1uK7-3MYPsn_2pH5skNSUFd8hHYxzsZdi6OHLzKeQ1MlzJFNVM5RBokQSiOQC5DRJl6zV2misBc0B6i6DNYKjTqR4cDfJUeicavfNA_yXmJGsQ4qWCBG8_BE4-vZjrSILTmngmlSB_rFgqKApBreeql2ZBuhk0Bx_YQDRwrNutvGR7uZ6cfMK3qmza36acktwUqfTUypF9j5LPRG5k7c-KYQOXcJnv1Vn41dvPEOhWxR2qfDtrjTGmhtYDtTGh2l9KQmV2dD4NJhp5dUX_LF_kK-aI3DP7TkUPd1BPwbmb4OiKRxgwpSXWL5dOMmVZjY_M2EWFiu-a5CRxZKM2gphSuJpi2JkVbnTuVcSApXfseAM3uYZz5SQYI70l6DXpGL9bbnyPCuZSji9gEUFO6LuVeAUy4EXi4ud60j" onmousedown="this.setAttribute(&#39;href&#39;,this.getAttribute(&#39;data-click-url&#39;));">      <span class="logly-lift-ad-title">openFrameworksでオブジェクトを追跡するカメラを作る</span>    </a>    <span class="logly-lift-ad-author">by takata182</span>  </div　class="logly-lift-ad-content"></div></div><div class="logly-lift-ad">  <span class="logly-lift-ad-icon"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/569050d4ca3b445ae834b0501ba31e99" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/akase244/items/b801f435e85ea67a70eb" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-TDWpYiLT8jDCXsQN1kML2FDPX49L4txmpKJMUg-rM-f00jLVdh3pVofYnQxoRpaXotHPJ_luP9DoWMb_EgRH1IeRyHBWY2lROy3fv8pAtIVGE-oe1oQEr7ZOR3XGaVU5SfRGIagDCwyGBbH3iOLZu_CNiSfJ7fr-ISGF_r5hPYPdDa4iLCcVg_4BjSBVJhnLQEkW5c-3xMD25QDfBuUSoTHpJU6sohGoY3o0jRLeXqSf6Vcf5ihj0n9OdBwtR7iopC8NpuaeNk6X2ncl4Asot9hYMVRLfVrQ_RhNU8Xm9Rfv9MOdn2jjZLBmktexYuMj7HRfleleJ38AcJ7j2ZGrLH98AicK-9zTKG1IPhnqrxzDut7mzY_GggIvhvpYLe0oW4LG0QF_dVQTEa6se5T0syY5UXFJvDn4s64Qv1Yxj6FcQNr7RDV9pHOhSSyBOEnAN03GPYmbi5IS6Jgmkqyza4qB4MRmv0z87LHXq12JM2SDMxSm3OZkSJ0OdPRMN3WxBdfA1ycP6gEloW2NG09vfqKQ_JzYaLDICMN4Dn4kLLbYsfv_qniQsb" onmousedown="this.setAttribute(&#39;href&#39;,this.getAttribute(&#39;data-click-url&#39;));">      <span class="logly-lift-ad-title">HTML5のcanvas内の複数の画像をドラッグ＆ドロップさせてみる</span>    </a>    <span class="logly-lift-ad-author">by akase244</span>  </div　class="logly-lift-ad-content"></div><div class="logly-lift-ad">  <span class="logly-lift-ad-icon"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/a38b97375676f29ba64b350a9f520250" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/ledsun/items/1d8158c845f1de4d064f" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-TDWpYiLT8jDCXsQN1kML2FDPX49L4txmpndDP4qjBmDi_WfVxLXaJUKbm1tPa-MDNRpzphSkTwvr76Dqy-7R9V2sjcwmQ1YUGXY2qxjOmqeJ_Z1P85EC0gX8WJt101AMhadvI8ubO_PhM7jVRsTU_yFnM3YOgVtr6GxlaMnDgm8iCh12oTVkqcT2vMJWqn6GyHp85wKZNQnY34TDBkxoPW80jUBHLN7uT0zNmy5bMWt0nOM0hO4NrR8N5p4bSdQIr07JRNZSGDH-7O43E8_Ce7xNY9U2TQbp-mV2itkC5M9PAp5gHFyHNd6TpnD92ZfcNqdfjTavGT3E3ijg_XXCyQDBKB-c5yGqkXZbPfytfdejN0onnaZwDXQGXbdTsxBYdxh0urZJpe410U_o8gwJHAEvMScd2Bc0BgY_qjCITfFmWNokGG16u5wfDtYjauO-Hqo8GjD_LjNgrBiS4yJf8_TFSOSxJmTEP-6vylElimJihlTfm37DC_XYoZLYI46tfGczNrsspF8Te9ssVe5rx2QHZVGPSbfSzN0KgjDqy-TQ" onmousedown="this.setAttribute(&#39;href&#39;,this.getAttribute(&#39;data-click-url&#39;));">      <span class="logly-lift-ad-title">力学モデル描画ライブラリー Springy のご紹介</span>    </a>    <span class="logly-lift-ad-author">by ledsun</span>  </div　class="logly-lift-ad-content"></div><div class="logly-lift-ad">    <span class="logly-lift-ad-icon"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/original(1).jpg" width="18"></span>    <div　class="logly-lift-ad-content">      <a class="logly-lift-ad-link" href="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-TDWpYiLT8jDCXsQN1kML2FPiBgIrhk1UWJxdAUg6HsjhT_ezZ26om3Gv2gvxe8B13WwLAcKJl472EFa6sDQ8ECjo9aO7kLYYCR_Oya1pW2zRJllFGnMvFzlckJsR3pdegsg2c4zL-hRAA3uOJPF2leZe-F9_l7AeRMwLbyiKBvi0YiPU0BplDMRK8kNL9rsYwNwmaGYsSxQeMmIYM3nuHkRy-LebUuXGQUW3GsKDFMtcCb1F9wldc3B93HrJ0ZygowZEqtU_tIARyrPCgi_30nvQJbfRBfXcuVCw2OLEivZBzfYHP1VGoaDZPkMuSHG26akOPtwq0PofGZY8ZsPdX_sy8GIj5fpZO1sMAdgN-HfbYAPX6MXqFEhPiF3e5tzLSTHdvtEEGbXZcMJE9DGZnz-YOpIkvRUTs6Cd8nMrWLUhliGBClW2c4ARoCpF6hBIvMsj6Xx9JergmISJbHmf0NqqTQviICP82_W1_45BvGVSx-ux7i3oAW20-3XtAUlAjo6HO8ck2fqN9spVAjZbJv-6wwNJS8SJ5HfQqfRnSwdA" target="_blank" style="text-decoration:none;" rel="nofollow noopener">        <span class="logly-lift-ad-title">元エンジニアから見たITコンサルタントの面白みとは</span>      </a><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/bc" width="1" height="1" style="position: absolute; width: 1px; height: 1px; top: -32767px; left: -32767px;" alt="">      <span class="logly-lift-ad-adv">PR フューチャーアーキテクト</span>    </div　class="logly-lift-ad-content"></div><div class="logly-lift-ad">    <span class="logly-lift-ad-icon"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/compact.jpg" width="18"></span>    <div　class="logly-lift-ad-content">      <a class="logly-lift-ad-link" href="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-TDWpYiLT8jDCXsQN1kML2FogcOmBa6S_0suAvA4MNd0zpIxt-Lb9CSt0vB1Z6lUo41nP_4k3YREbR6hVNG31HRwqP8maBPxMmNRxV7LXn0-f9TWZH2mUQLpxYysXqeCzHxzYLpZOreE0sXZh_3fAZcp8hn-1STUW17Vu93srEbb-xWqhNH_BkMrLdvlqO5c00t4ITIplB2pWSXdqWJbVbi8eCnAZEOTspjFbuzJzmoqRDk3Il-DOT-Fkc4g0eHVEWsF1AChbRSguOPygkjGAHR-dd5WLYLqcSVZtotCUaUlXwpOesnUZHP2VXqU1qEzej69RvGZ1KXkD7VBSIawdxzKt9AWx7Nm3Bi19MDM3IAuhbtMC0VIsBHHltHhifdJx8lUET5yZcy4p4vcJAFxwgymDAY9_uWZGDTmeeTafVMyMlhJUpMvFsgaEvsYyHql36w2lCZNYGuOZznM8Xz7KBkwU8-l6OtIAnJJD48v0TGDS2cKuvb28ETIe3TtP5zj7SSPC0hNuc6F2OwrL7hNtsDWTuPjMfcw6tBxECQsyMbyMpE5VOCUis5dR7kRZpDr7hDTf4uhW4_8w" target="_blank" style="text-decoration:none;" rel="nofollow noopener">        <span class="logly-lift-ad-title">今こそ見直すべき自社のテレワーク環境／最適な対策とは？</span>      </a><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/bc(1)" width="1" height="1" style="position: absolute; width: 1px; height: 1px; top: -32767px; left: -32767px;" alt="">      <span class="logly-lift-ad-adv">PR 株式会社インテック</span>    </div　class="logly-lift-ad-content"></div>    <div class="logly-lift-clear"></div></div></div><div class="p-items_aside mt-5 px-5 p-2@s"></div><div></div><div class="p-items_aside mt-6 px-5 p-2@s" id="comments-wrapper"><div id="comments" class="co-ItemWrapper"><div class="co-ItemWrapper_title mb-2"><span class="fa fa-comments mr-1"></span>コメント</div><div class="mb-4">この記事にコメントはありません。</div><div class="co-AnonymousForm p-3"><div class="co-AnonymousForm_title mb-1">あなたもコメントしてみませんか :)</div><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=https%3A%2F%2Fqiita.com%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596&amp;realm=qiita" class="co-AnonymousForm_signup">ユーザー登録</a><div class="co-AnonymousForm_sub mt-1">すでにアカウントを持っている方は<a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=https%3A%2F%2Fqiita.com%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596&amp;realm=qiita" class="co-AnonymousForm_login">ログイン</a></div></div></div></div></div><div class="p-items_rightDummy"></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-ac38a70c-7772-494f-9f70-a4846208032b">{"article":{"body":"\u003cp\u003e以下の記事で HTML5 Canvas に入門しました。\u003cbr\u003e\n\u003ca href=\"http://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0\" class=\"autolink\" id=\"reference-c53464189999dbb4a9d0\"\u003ehttp://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eが、どうせなら描画した要素をドラッグでぐりぐり動かすくらいは、やってみたいところです。\u003cbr\u003e\nやってみました。\u003c/p\u003e\n\n\u003cp\u003eコードだけ見たい方はこちらを。\u003cbr\u003e\n\u003ca href=\"https://github.com/kyrieleison/canvas-dragging-tutorial/blob/master/index.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/kyrieleison/canvas-dragging-tutorial/blob/master/index.html\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"キャンバスを準備する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%92%E6%BA%96%E5%82%99%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eキャンバスを準備する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u0026lt;!DOCTYPE html\u0026gt;\n\u0026lt;html\u0026gt;\n  \u0026lt;head\u0026gt;\n    \u0026lt;title\u0026gt;canvas tutorial\u0026lt;/title\u0026gt;\n    \u0026lt;style\u0026gt;\n      #canvas {\n        background: #666;\n      }\n    \u0026lt;/style\u0026gt;\n  \u0026lt;/head\u0026gt;\n  \u0026lt;body\u0026gt;\n    \u0026lt;canvas id=\"canvas\" width=\"640\" height=\"480\"\u0026gt;\u0026lt;/canvas\u0026gt;\n    \u0026lt;script\u0026gt;\n      // ここにコードを書いていきます\n    \u0026lt;/script\u0026gt;\n  \u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまずは HTML の雛形です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ドラッグで動かすオブジェクトを初期表示する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%88%9D%E6%9C%9F%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eドラッグで動かすオブジェクトを初期表示する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003evar canvas = document.getElementById(\"canvas\");\nvar context = canvas.getContext('2d');\nvar objX, objY;\nvar objWidth, objHeight;\n\nfunction init() {\n  // オブジェクトの大きさを定義\n  objWidth = 50;\n  objHeight = 50;\n\n  // オブジェクトの座標を定義(キャンバスの中央に表示)\n  objX = canvas.width / 2 - objWidth / 2;\n  objY = canvas.height / 2 - objHeight / 2;\n\n  // オブジェクトを描画\n  drawRect();\n}\n\nfunction drawRect() {\n  context.fillRect(objX, objY, objWidth, objHeight);\n}\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまずはドラッグで動かす対象となるオブジェクトを表示します。\u003cbr\u003e\n今回は縦50px X 横50px のシンプルな正方形をキャンバスの中央に表示する \u003ccode\u003einit()\u003c/code\u003e 関数を定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u0026lt;body onLoad=\"init()\"\u0026gt;\n  \u0026lt;canvas id=\"canvas\" width=\"640\" height=\"480\"\u0026gt;\u0026lt;/canvas\u0026gt;\n  \u0026lt;script\u0026gt;\n    ...\n  \u0026lt;/script\u0026gt;\n\u0026lt;/body\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eそして \u003ccode\u003ebody\u003c/code\u003e タグで雑な感じに \u003ccode\u003einit()\u003c/code\u003e 関数を実行するようにします。\u003cbr\u003e\nこれでキャンバスにオブジェクトが表示されるようになりました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"マウス座標を取得しオブジェクトかどうかを判定する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%82%A6%E3%82%B9%E5%BA%A7%E6%A8%99%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマウス座標を取得し、オブジェクトかどうかを判定する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003evar x, y, relX, relY;\nvar dragging = false;\n\nfunction onDown(e) {\n  // キャンバスの左上端の座標を取得\n  var offsetX = canvas.getBoundingClientRect().left;\n  var offsetY = canvas.getBoundingClientRect().top;\n\n  // マウスが押された座標を取得\n  x = e.clientX - offsetX;\n  y = e.clientY - offsetY;\n\n  // オブジェクト上の座標かどうかを判定\n  if (objX \u0026lt; x \u0026amp;\u0026amp; (objX + objWidth) \u0026gt; x \u0026amp;\u0026amp; objY \u0026lt; y \u0026amp;\u0026amp; (objY + objHeight) \u0026gt; y) {\n    dragging = true; // ドラッグ開始\n    relX = objX - x;\n    relY = objY - y;\n  }\n}\n\ncanvas.addEventListener('mousedown', onDown, false);\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次に、マウスの左ボタンが押されたときに、それがオブジェクト上なのかどうかを判定します。\u003cbr\u003e\n押されたのがオブジェクト上であればドラッグ開始(\u003ccode\u003edragging = true\u003c/code\u003e)と見なし、オブジェクト上でなければ何もしません。\u003c/p\u003e\n\n\u003cp\u003eマウスが押された座標を取得するためには、\u003ccode\u003ecanvas.getBoundingClientRect()\u003c/code\u003e メソッドで画面上でのキャンバスの座標を取得します。\u003cbr\u003e\n\u003ccode\u003eclientX/Y\u003c/code\u003e プロパティで取得した画面上の座標から、キャンバス座標を減算することでキャンバス内の相対位置を取得できます。\u003c/p\u003e\n\n\u003cp\u003e座標は常にオブジェクトの左上を指し、右あるいは下に行くほど大きな値となるため、オブジェクト上の座標かどうかは以下のような判定条件になります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eobjX \u0026lt; x\u003c/code\u003e: オブジェクトの左端よりも右で押された場合\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e(objX + objWidth) \u0026gt; x\u003c/code\u003e: オブジェクトの右端よりも左で押された場合\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eobjY \u0026lt; y\u003c/code\u003e: オブジェクトの上端よりも下で押された場合\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e(objY + objHeight) \u0026gt; x\u003c/code\u003e: オブジェクトの下端よりも上で押された場合\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eこれらの判定条件をクリアすると\u003cstrong\u003eオブジェクトの上でドラッグが開始された\u003c/strong\u003eとみなすことができるので、\u003ccode\u003edragging\u003c/code\u003e フラグを \u003ccode\u003etrue\u003c/code\u003e にします。\u003cbr\u003e\nまた、オブジェクトとマウス座標との差分を \u003ccode\u003erelX/Y\u003c/code\u003e に格納しておきます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ドラッグでオブジェクトを移動する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E7%A7%BB%E5%8B%95%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eドラッグでオブジェクトを移動する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003efunction onMove(e) {\n  // キャンバスの左上端の座標を取得\n  var offsetX = canvas.getBoundingClientRect().left;\n  var offsetY = canvas.getBoundingClientRect().top;\n\n  // マウスが移動した先の座標を取得\n  x = e.clientX - offsetX;\n  y = e.clientY - offsetY;\n\n  // ドラッグが開始されていればオブジェクトの座標を更新して再描画\n  if (dragging) {\n    objX = x + relX;\n    objY = y + relY;\n    drawRect();\n  }\n}\n\nfunction onUp(e) {\n  dragging = false; // ドラッグ終了\n}\n\nfunction drawRect() {\n  context.clearRect(0, 0, canvas.width, canvas.height); // キャンバスをクリア\n  context.fillRect(objX, objY, objWidth, objHeight);\n}\n\ncanvas.addEventListener('mousemove', onMove, false);\ncanvas.addEventListener('mouseup', onUp, false);\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eキャンバス上をドラッグしてオブジェクトを移動するには、\u003cstrong\u003e今描画しているオブジェクトを消去して、次のマウス座標上にオブジェクトを再描画する\u003c/strong\u003eということをします。\u003c/p\u003e\n\n\u003cp\u003eマウス移動を常に監視し、オブジェクト上でドラッグが開始していればその移動先のマウス座標でオブジェクトを描画します。\u003cbr\u003e\nそして、マウスの左ボタンが離されたらドラッグを終了と見なします。\u003c/p\u003e\n\n\u003cp\u003eこのときに、前の位置のオブジェクトがキャンバス上に残り続けてしまうため、\u003ccode\u003econtext.clearRect()\u003c/code\u003e メソッドで描画する度にキャンバス全体をクリアします。\u003c/p\u003e\n\n\u003cp\u003eこれでキャンバス上でのドラッグ移動ができました。\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e今回は以下の記事やコードを参考にさせていただきました。\u003cbr\u003e\n\u003ca href=\"http://rika.edu.gunma-u.ac.jp/~terasima/junk/ex07.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://rika.edu.gunma-u.ac.jp/~terasima/junk/ex07.html\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://lab.ve-lo.net/?p=312\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://lab.ve-lo.net/?p=312\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://qiita.com/akase244/items/b801f435e85ea67a70eb\" class=\"autolink\" id=\"reference-b4989f13b30be6b7a5d1\"\u003ehttp://qiita.com/akase244/items/b801f435e85ea67a70eb\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eただ、この実装では複数のオブジェクトが描画されたときに、ドラッグする度に他のオブジェクトもクリアされてしまいます。\u003cbr\u003e\nオブジェクトが長方形でないと判定の仕方も変わりますし、オブジェクトの重ね順についても考慮されていません。\u003c/p\u003e\n\n\u003cp\u003e通常の DOM 要素であれば HTML5 Drag \u0026amp; Drop API で比較的簡単に実装できるようですが、キャンバスだと座標計算をごりごりするコードになりそうです。\u003cbr\u003e\nユーザに描画をさせるような機能であれば別ですが、単にドラッグアンドドロップを実現するのであれば、キャンバスは避けた方がいいかもしれませんね。\u003c/p\u003e\n","createdAt":"2016-05-17T15:44:12Z","elapsedYearsFromUpdatedAt":4,"encryptedId":"L49DFI/kOG2TCAvtQ3ZpNgx/91dlu5p3--YM0SH5eQ44E+vsdM--YUNaNo/i4Sv9aT8dKIdpAA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestSendableByViewer":true,"isEditRequestReadableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"likesCount":48,"linkUrl":"https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596","originalId":393207,"stockedCount":65,"title":"HTML5 Canvas でドラッグ操作","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%92%E6%BA%96%E5%82%99%E3%81%99%E3%82%8B\"\u003eキャンバスを準備する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%88%9D%E6%9C%9F%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\"\u003eドラッグで動かすオブジェクトを初期表示する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%82%A6%E3%82%B9%E5%BA%A7%E6%A8%99%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B\"\u003eマウス座標を取得し、オブジェクトかどうかを判定する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E7%A7%BB%E5%8B%95%E3%81%99%E3%82%8B\"\u003eドラッグでオブジェクトを移動する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":29027,"updatedAt":"2016-05-17T15:44:12Z","uuid":"26fcfb3a1d94bc92c596","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"FXUyV2KYnUdem6yDda6bxmS2DAM=--oNIqNoT/zPpRBH8h--dW9bZxPV1K+EnhXc6Lqc0g==","originalId":44003,"description":null,"name":"Yuka Tsuboi","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/44003/profile-images/1537150852","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F44003%2Fprofile-images%2F1537150852?ixlib=rb-1.2.2\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=a87e5f41208918252f1748f0cb61fe0a","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F44003%2Fprofile-images%2F1537150852?ixlib=rb-1.2.2\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=6ba3e16efdefb8e998aeb36b7bc6ff59","urlName":"kyrieleison","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"websiteUrl":"","facebookUrl":"https://facebook.com/to.kyrie.leison","githubUrl":"https://github.com/kyrieleison","linkedinUrl":null,"twitterUrl":"https://twitter.com/__kyrieleison__","twitterUrlName":"__kyrieleison__","revealedOrganizations":{"edges":[{"node":{"name":"株式会社ガイアックス","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/646b13eb1e51a484163f320913d23a40d3f40fe1/original.jpg?1468893400","urlName":"gaiax","description":"人と人をつなげる　Empowering the people to connect.","url":"http://www.gaiax.co.jp/"}}]}},"tags":[{"name":"JavaScript","urlName":"javascript"},{"name":"HTML5","urlName":"html5"},{"name":"canvas","urlName":"canvas"},{"name":"入門","urlName":"%e5%85%a5%e9%96%80"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0},"organization":null},"analyticsTrackingId":null}</script>
      
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/td_qt_access.js" type="text/javascript"></script><script>microadTd.QT.start({"article_category": "JavaScript,HTML5,canvas,入門"})</script><script>(function(d,u){var b=d.getElementsByTagName("script")[0],j=d.createElement("script");j.async=true;j.src=u;b.parentNode.insertBefore(j,b);})(document,"//img.ak.impact-ad.jp/ut/ff9a3577423c8ed5_4330.js");</script><noscript><iframe frameborder="0" height="0" src="//nspt.unitag.jp/ff9a3577423c8ed5_4330.php" width="0"></iframe></noscript><script async="" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/js(2)"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'AW-878053044');</script><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1792588824374455');
fbq('track', 'PageView');</script><noscript><img height="1" src="https://www.facebook.com/tr?id=1792588824374455&amp;ev=PageView&amp;noscript=1" style="display:none" width="1" /></noscript><footer id="globalFooter" class="st-Footer"><div class="st-Footer_container"><div class="st-Footer_start"><div class="st-Footer_logo"><svg viewBox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></div><div class="st-Footer_catchcopy">How developers code is here.</div><div class="st-Footer_socials"><a class="fa fa-twitter" href="https://twitter.com/qiita"></a><a class="fa fa-facebook-square" href="https://www.facebook.com/qiita/"></a></div></div><div class="st-Footer_end"><div class="st-Footer_qiita"><div class="st-Footer_label">Qiita</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://qiita.com/about">About</a><a href="https://qiita.com/terms">利用規約</a><a href="https://qiita.com/privacy">プライバシー</a><a target="_blank" href="http://help.qiita.com/ja/articles/qiita-community-guideline">ガイドライン</a><a href="https://qiita.com/release-notes">リリース</a></div><div class="st-Footer_column"><a href="https://qiita.com/api/v2/docs">API</a><a href="https://qiita.com/feedback/new">ご意見</a><a href="https://help.qiita.com/">ヘルプ</a><a target="_blank" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">広告掲載</a></div></div></div><div class="st-Footer_increments"><div class="st-Footer_label">Increments</div><div class="st-Footer_list"><div class="st-Footer_column"><a href="https://increments.co.jp/company/">About</a><a href="https://increments.co.jp/jobs/">採用情報</a><a href="https://blog.qiita.com/">ブログ</a></div><div class="st-Footer_column"><a href="https://teams.qiita.com/">Qiita Team</a><a href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a><a href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></div></div></div></div></div><div class="st-Footer_copyright">© 2011-2021 Increments Inc.</div></footer><div id="Snackbar-react-component-34424c14-f0e5-4c77-8ca8-55115c911ef0"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-34424c14-f0e5-4c77-8ca8-55115c911ef0">{}</script>
      
<div id="LoginModal-react-component-0a59a107-28d0-47d8-8c64-c120a9348747"><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body lm-Dialog"><div class="fa fa-times lm-Dialog_close"></div><div class="lm-Dialog_title">ユーザー登録して、Qiitaをもっと便利に使ってみませんか。</div><div class="lm-Dialog_message-pc">この機能を利用するにはログインする必要があります。ログインするとさらに便利にQiitaを利用できます。</div><div class="lm-Dialog_message-mobile">この機能を利用するにはログインする必要があります。ログインするとさらに便利にQiitaを利用できます。</div><ol class="lm-Dialog_list"><li>あなたにマッチした記事をお届けします<div class="description">ユーザーやタグをフォローすることで、あなたが興味を持つ技術分野の情報をまとめてキャッチアップできます</div></li><li>便利な情報をあとで効率的に読み返せます<div class="description">気に入った記事を「ストック」することで、あとからすぐに検索できます</div></li></ol><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596&amp;realm=qiita" class="lm-Dialog_button lm-Dialog_button-signup">登録する</a><a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=%2Fkyrieleison%2Fitems%2F26fcfb3a1d94bc92c596&amp;realm=qiita" class="lm-Dialog_button lm-Dialog_button-signin">ログインする</a></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-0a59a107-28d0-47d8-8c64-c120a9348747">{}</script>
      
<div id="UserHoverCard-react-component-8953c3ea-9024-405d-acfd-39846e860a31"><div class="uh-Container" style="left: 0px; top: 0px;"><div>ユーザーは見つかりませんでした</div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="UserHoverCard" data-dom-id="UserHoverCard-react-component-8953c3ea-9024-405d-acfd-39846e860a31">{}</script>
      
<div id="StockModal-react-component-af5d74e2-1bb9-4028-993d-d90e43630ef0"><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body css-obxdku"><div class="css-e5tuit"><div class="css-1gykiw6">ストックするカテゴリー</div><button type="button" class="css-g11wic"><span class="fa fa-times fa-fw css-1wvl6ln"></span></button></div><div class="css-jzs3ao"></div><div class="css-15yu7eo"><button type="button" class="css-1mteic8"><span class="fa fa-plus fa-fw css-a8h57e"></span><div class="css-1jytrtk">カテゴリーの新規作成</div></button></div><div class="css-1mkdie5"><button class="css-14122k e1rb7ucl0" disabled="">保存する</button></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-af5d74e2-1bb9-4028-993d-d90e43630ef0">{}</script>
      
</div><script type="text/javascript" charset="UTF-8">!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["blockEvents","unblockEvents","setSignedMode","setAnonymousMode","resetUUID","addRecord","fetchGlobalID","set","trackEvent","trackPageview","trackClicks","ready"],n=0;n<s.length;n++){var c=s[n];e[t].prototype[c]=r(c)}var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/2.1/td.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)}}("Treasure",this);</script><script type="text/javascript" charset="UTF-8" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/aid"></script><img width="0px" height="0px" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tr" style="display: none;"><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;KM1A95DaF+ugghhV+JgGYQUYPNbqot4ugnWAUUAzyFGaYbvtNvMe89W2UvGli0xpvkNtGoZsU+o/eXQW2hbPsw==&quot;,&quot;locale&quot;:&quot;ja&quot;},&quot;currentUser&quot;:null}"><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e以下の記事で HTML5 Canvas に入門しました。\u003cbr\u003e\n\u003ca href=\"http://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0\" class=\"autolink\" id=\"reference-c53464189999dbb4a9d0\"\u003ehttp://qiita.com/kyrieleison/items/a3ebf7c55295c3e7d8f0\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eが、どうせなら描画した要素をドラッグでぐりぐり動かすくらいは、やってみたいところです。\u003cbr\u003e\nやってみました。\u003c/p\u003e\n\n\u003cp\u003eコードだけ見たい方はこちらを。\u003cbr\u003e\n\u003ca href=\"https://github.com/kyrieleison/canvas-dragging-tutorial/blob/master/index.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/kyrieleison/canvas-dragging-tutorial/blob/master/index.html\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"キャンバスを準備する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%92%E6%BA%96%E5%82%99%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eキャンバスを準備する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u0026lt;!DOCTYPE html\u0026gt;\n\u0026lt;html\u0026gt;\n  \u0026lt;head\u0026gt;\n    \u0026lt;title\u0026gt;canvas tutorial\u0026lt;/title\u0026gt;\n    \u0026lt;style\u0026gt;\n      #canvas {\n        background: #666;\n      }\n    \u0026lt;/style\u0026gt;\n  \u0026lt;/head\u0026gt;\n  \u0026lt;body\u0026gt;\n    \u0026lt;canvas id=\"canvas\" width=\"640\" height=\"480\"\u0026gt;\u0026lt;/canvas\u0026gt;\n    \u0026lt;script\u0026gt;\n      // ここにコードを書いていきます\n    \u0026lt;/script\u0026gt;\n  \u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまずは HTML の雛形です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ドラッグで動かすオブジェクトを初期表示する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%88%9D%E6%9C%9F%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eドラッグで動かすオブジェクトを初期表示する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003evar canvas = document.getElementById(\"canvas\");\nvar context = canvas.getContext('2d');\nvar objX, objY;\nvar objWidth, objHeight;\n\nfunction init() {\n  // オブジェクトの大きさを定義\n  objWidth = 50;\n  objHeight = 50;\n\n  // オブジェクトの座標を定義(キャンバスの中央に表示)\n  objX = canvas.width / 2 - objWidth / 2;\n  objY = canvas.height / 2 - objHeight / 2;\n\n  // オブジェクトを描画\n  drawRect();\n}\n\nfunction drawRect() {\n  context.fillRect(objX, objY, objWidth, objHeight);\n}\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまずはドラッグで動かす対象となるオブジェクトを表示します。\u003cbr\u003e\n今回は縦50px X 横50px のシンプルな正方形をキャンバスの中央に表示する \u003ccode\u003einit()\u003c/code\u003e 関数を定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u0026lt;body onLoad=\"init()\"\u0026gt;\n  \u0026lt;canvas id=\"canvas\" width=\"640\" height=\"480\"\u0026gt;\u0026lt;/canvas\u0026gt;\n  \u0026lt;script\u0026gt;\n    ...\n  \u0026lt;/script\u0026gt;\n\u0026lt;/body\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eそして \u003ccode\u003ebody\u003c/code\u003e タグで雑な感じに \u003ccode\u003einit()\u003c/code\u003e 関数を実行するようにします。\u003cbr\u003e\nこれでキャンバスにオブジェクトが表示されるようになりました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"マウス座標を取得しオブジェクトかどうかを判定する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%82%A6%E3%82%B9%E5%BA%A7%E6%A8%99%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマウス座標を取得し、オブジェクトかどうかを判定する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003evar x, y, relX, relY;\nvar dragging = false;\n\nfunction onDown(e) {\n  // キャンバスの左上端の座標を取得\n  var offsetX = canvas.getBoundingClientRect().left;\n  var offsetY = canvas.getBoundingClientRect().top;\n\n  // マウスが押された座標を取得\n  x = e.clientX - offsetX;\n  y = e.clientY - offsetY;\n\n  // オブジェクト上の座標かどうかを判定\n  if (objX \u0026lt; x \u0026amp;\u0026amp; (objX + objWidth) \u0026gt; x \u0026amp;\u0026amp; objY \u0026lt; y \u0026amp;\u0026amp; (objY + objHeight) \u0026gt; y) {\n    dragging = true; // ドラッグ開始\n    relX = objX - x;\n    relY = objY - y;\n  }\n}\n\ncanvas.addEventListener('mousedown', onDown, false);\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次に、マウスの左ボタンが押されたときに、それがオブジェクト上なのかどうかを判定します。\u003cbr\u003e\n押されたのがオブジェクト上であればドラッグ開始(\u003ccode\u003edragging = true\u003c/code\u003e)と見なし、オブジェクト上でなければ何もしません。\u003c/p\u003e\n\n\u003cp\u003eマウスが押された座標を取得するためには、\u003ccode\u003ecanvas.getBoundingClientRect()\u003c/code\u003e メソッドで画面上でのキャンバスの座標を取得します。\u003cbr\u003e\n\u003ccode\u003eclientX/Y\u003c/code\u003e プロパティで取得した画面上の座標から、キャンバス座標を減算することでキャンバス内の相対位置を取得できます。\u003c/p\u003e\n\n\u003cp\u003e座標は常にオブジェクトの左上を指し、右あるいは下に行くほど大きな値となるため、オブジェクト上の座標かどうかは以下のような判定条件になります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eobjX \u0026lt; x\u003c/code\u003e: オブジェクトの左端よりも右で押された場合\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e(objX + objWidth) \u0026gt; x\u003c/code\u003e: オブジェクトの右端よりも左で押された場合\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eobjY \u0026lt; y\u003c/code\u003e: オブジェクトの上端よりも下で押された場合\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e(objY + objHeight) \u0026gt; x\u003c/code\u003e: オブジェクトの下端よりも上で押された場合\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eこれらの判定条件をクリアすると\u003cstrong\u003eオブジェクトの上でドラッグが開始された\u003c/strong\u003eとみなすことができるので、\u003ccode\u003edragging\u003c/code\u003e フラグを \u003ccode\u003etrue\u003c/code\u003e にします。\u003cbr\u003e\nまた、オブジェクトとマウス座標との差分を \u003ccode\u003erelX/Y\u003c/code\u003e に格納しておきます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ドラッグでオブジェクトを移動する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E7%A7%BB%E5%8B%95%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eドラッグでオブジェクトを移動する\u003c/h1\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003efunction onMove(e) {\n  // キャンバスの左上端の座標を取得\n  var offsetX = canvas.getBoundingClientRect().left;\n  var offsetY = canvas.getBoundingClientRect().top;\n\n  // マウスが移動した先の座標を取得\n  x = e.clientX - offsetX;\n  y = e.clientY - offsetY;\n\n  // ドラッグが開始されていればオブジェクトの座標を更新して再描画\n  if (dragging) {\n    objX = x + relX;\n    objY = y + relY;\n    drawRect();\n  }\n}\n\nfunction onUp(e) {\n  dragging = false; // ドラッグ終了\n}\n\nfunction drawRect() {\n  context.clearRect(0, 0, canvas.width, canvas.height); // キャンバスをクリア\n  context.fillRect(objX, objY, objWidth, objHeight);\n}\n\ncanvas.addEventListener('mousemove', onMove, false);\ncanvas.addEventListener('mouseup', onUp, false);\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eキャンバス上をドラッグしてオブジェクトを移動するには、\u003cstrong\u003e今描画しているオブジェクトを消去して、次のマウス座標上にオブジェクトを再描画する\u003c/strong\u003eということをします。\u003c/p\u003e\n\n\u003cp\u003eマウス移動を常に監視し、オブジェクト上でドラッグが開始していればその移動先のマウス座標でオブジェクトを描画します。\u003cbr\u003e\nそして、マウスの左ボタンが離されたらドラッグを終了と見なします。\u003c/p\u003e\n\n\u003cp\u003eこのときに、前の位置のオブジェクトがキャンバス上に残り続けてしまうため、\u003ccode\u003econtext.clearRect()\u003c/code\u003e メソッドで描画する度にキャンバス全体をクリアします。\u003c/p\u003e\n\n\u003cp\u003eこれでキャンバス上でのドラッグ移動ができました。\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e今回は以下の記事やコードを参考にさせていただきました。\u003cbr\u003e\n\u003ca href=\"http://rika.edu.gunma-u.ac.jp/~terasima/junk/ex07.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://rika.edu.gunma-u.ac.jp/~terasima/junk/ex07.html\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://lab.ve-lo.net/?p=312\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://lab.ve-lo.net/?p=312\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://qiita.com/akase244/items/b801f435e85ea67a70eb\" class=\"autolink\" id=\"reference-b4989f13b30be6b7a5d1\"\u003ehttp://qiita.com/akase244/items/b801f435e85ea67a70eb\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eただ、この実装では複数のオブジェクトが描画されたときに、ドラッグする度に他のオブジェクトもクリアされてしまいます。\u003cbr\u003e\nオブジェクトが長方形でないと判定の仕方も変わりますし、オブジェクトの重ね順についても考慮されていません。\u003c/p\u003e\n\n\u003cp\u003e通常の DOM 要素であれば HTML5 Drag \u0026amp; Drop API で比較的簡単に実装できるようですが、キャンバスだと座標計算をごりごりするコードになりそうです。\u003cbr\u003e\nユーザに描画をさせるような機能であれば別ですが、単にドラッグアンドドロップを実現するのであれば、キャンバスは避けた方がいいかもしれませんね。\u003c/p\u003e\n","createdAt":"2016-05-17T15:44:12Z","elapsedYearsFromUpdatedAt":4,"encryptedId":"L49DFI/kOG2TCAvtQ3ZpNgx/91dlu5p3--YM0SH5eQ44E+vsdM--YUNaNo/i4Sv9aT8dKIdpAA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestSendableByViewer":true,"isEditRequestReadableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":false,"likesCount":48,"linkUrl":"https://qiita.com/kyrieleison/items/26fcfb3a1d94bc92c596","originalId":393207,"stockedCount":65,"title":"HTML5 Canvas でドラッグ操作","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%92%E6%BA%96%E5%82%99%E3%81%99%E3%82%8B\"\u003eキャンバスを準備する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%88%9D%E6%9C%9F%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\"\u003eドラッグで動かすオブジェクトを初期表示する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%82%A6%E3%82%B9%E5%BA%A7%E6%A8%99%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B\"\u003eマウス座標を取得し、オブジェクトかどうかを判定する\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%89%E3%83%A9%E3%83%83%E3%82%B0%E3%81%A7%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E7%A7%BB%E5%8B%95%E3%81%99%E3%82%8B\"\u003eドラッグでオブジェクトを移動する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":29027,"updatedAt":"2016-05-17T15:44:12Z","uuid":"26fcfb3a1d94bc92c596","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"FXUyV2KYnUdem6yDda6bxmS2DAM=--oNIqNoT/zPpRBH8h--dW9bZxPV1K+EnhXc6Lqc0g==","originalId":44003,"description":null,"name":"Yuka Tsuboi","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/44003/profile-images/1537150852","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F44003%2Fprofile-images%2F1537150852?ixlib=rb-1.2.2\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=a87e5f41208918252f1748f0cb61fe0a","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F44003%2Fprofile-images%2F1537150852?ixlib=rb-1.2.2\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=6ba3e16efdefb8e998aeb36b7bc6ff59","urlName":"kyrieleison","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"websiteUrl":"","facebookUrl":"https://facebook.com/to.kyrie.leison","githubUrl":"https://github.com/kyrieleison","linkedinUrl":null,"twitterUrl":"https://twitter.com/__kyrieleison__","twitterUrlName":"__kyrieleison__","revealedOrganizations":{"edges":[{"node":{"name":"株式会社ガイアックス","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/646b13eb1e51a484163f320913d23a40d3f40fe1/original.jpg?1468893400","urlName":"gaiax","description":"人と人をつなげる　Empowering the people to connect.","url":"http://www.gaiax.co.jp/"}}]}},"tags":[{"name":"JavaScript","urlName":"javascript"},{"name":"HTML5","urlName":"html5"},{"name":"canvas","urlName":"canvas"},{"name":"入門","urlName":"%e5%85%a5%e9%96%80"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0},"organization":null},"comments":[],"client":null,"ads_event_emitter":null}}</script></div><div id="itm_4330" style="visibility: hidden; display: none;"></div><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/pixel(1)" width="1" height="1" style="display: none;"><iframe id="aopb_ff9a3577423c8ed5" frameborder="0" scrolling="no" width="1" height="1" style="display: none" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/pb.html"></iframe><iframe id="google_osd_static_frame_1599542662796" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/saved_resource(2).html"></iframe><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==" width="1" height="1" border="0" class="bigmining_dmp_beacon" style="display: none;"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==" width="1" height="1" border="0" class="bigmining_dmp_beacon" style="display: none;"><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct" width="1" height="1" border="0" class="bigmining_dmp_beacon" style="display: none;"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-58Z82M');</script><img src="./HTML5 Canvas でドラッグ操作 - Qiita_files/rep" style="display: none;"><iframe src="./HTML5 Canvas でドラッグ操作 - Qiita_files/pixel(3).html" style="display: none;"></iframe><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/activityi.html"></iframe><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/activityi(1).html"></iframe><div style="display: none; visibility: hidden;"><iframe src="./HTML5 Canvas でドラッグ操作 - Qiita_files/activityi(2).html" width="1" height="1" frameborder="0" style="display:none"></iframe></div><div style="display: none; visibility: hidden;"><iframe src="./HTML5 Canvas でドラッグ操作 - Qiita_files/activityi(3).html" width="1" height="1" frameborder="0" style="display:none"></iframe></div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nv2kc",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","809797712462041");fbq("track","PageView");</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script>!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","nxmb9");twq("track","PageView");</script>
</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","996402550503199");fbq("track","PageView");</script>
<noscript></noscript>

</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","954575148009345");fbq("track","PageView");</script>
<noscript></noscript>

</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","437265843064161");fbq("track","PageView");</script>
<noscript></noscript>


</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nw0lq",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nw1xy",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nw9n2",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","262978464137256");fbq("track","PageView");</script>
<noscript></noscript>


</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","256605841418458");fbq("track","PageView");</script>
<noscript></noscript>


</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","386990638325508");fbq("track","PageView");</script>
<noscript></noscript>


</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nxlif",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nxlih",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nxyp7",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("ny46g",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1733466696949178");fbq("track","PageView");</script>
<noscript></noscript>


</div><div style="display: none; visibility: hidden;">
<script>!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","ny5vy");twq("track","PageView");</script>
</div><div style="display: none; visibility: hidden;"><script type="text/javascript">var _fout_queue=_fout_queue||{};void 0===_fout_queue.segment&&(_fout_queue.segment={});void 0===_fout_queue.segment.queue&&(_fout_queue.segment.queue=[]);_fout_queue.segment.queue.push({user_id:19972,advertiser_id:6796,contractor_id:5});(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://":"http://")+"js.fout.jp/segmentation.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script>
        </div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"4740006retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"4813012retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"4813013retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"4813014retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"4815034retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"4815035retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"4813015retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","2040876882868599");fbq("track","PageView");</script>
<noscript></noscript>


</div><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1469129556533591");fbq("track","PageView");</script>
<noscript></noscript>

</div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"5048036retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"5048036retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"5053023retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript></div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"5048036retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;"><script type="text/javascript">window._tfa=window._tfa||[];_tfa.push({notify:"mark",type:"5054022retargeting"});</script>
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/tfa.js"></script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;"><script type="text/javascript">var _fout_queue=_fout_queue||{};void 0===_fout_queue.segment&&(_fout_queue.segment={});void 0===_fout_queue.segment.queue&&(_fout_queue.segment.queue=[]);_fout_queue.segment.queue.push({user_id:21947,advertiser_id:8063,contractor_id:5});(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://":"http://")+"js.fout.jp/segmentation.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script>
        
        </div><div style="display: none; visibility: hidden;">
<script type="text/javascript">!function(){if(window.SmartnewsAds=window.SmartnewsAds||{},!window.SmartnewsAds.p){var a=window.SmartnewsAds.p=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)};window.SmartnewsAds._p||(window.SmartnewsAds._p=a);a.push=a;a.version="1.0.0";a.queue=[];var b=document.createElement("script");b.async=!0;b.src="//cdn.smartnews-ads.com/i/pixel.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}}();SmartnewsAds.p("c2e22923c3676a816c61d14d","PageView");</script>
<noscript></noscript></div><div style="display: none; visibility: hidden;">
<script type="text/javascript">!function(){if(window.SmartnewsAds=window.SmartnewsAds||{},!window.SmartnewsAds.p){var a=window.SmartnewsAds.p=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)};window.SmartnewsAds._p||(window.SmartnewsAds._p=a);a.push=a;a.version="1.0.0";a.queue=[];var b=document.createElement("script");b.async=!0;b.src="//cdn.smartnews-ads.com/i/pixel.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}}();SmartnewsAds.p("218d489b0df6609f4876420b","PageView");</script>
<noscript></noscript>

</div><div style="display: none; visibility: hidden;">
<script>!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","nzdtr");twq("track","PageView");</script>
</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nziop",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script type="text/javascript">!function(){if(window.SmartnewsAds=window.SmartnewsAds||{},!window.SmartnewsAds.p){var a=window.SmartnewsAds.p=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)};window.SmartnewsAds._p||(window.SmartnewsAds._p=a);a.push=a;a.version="1.0.0";a.queue=[];var b=document.createElement("script");b.async=!0;b.src="//cdn.smartnews-ads.com/i/pixel.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}}();SmartnewsAds.p("4fc5ab48b835653a76f95b96","PageView");</script>
<noscript></noscript></div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nznn0",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("nznn2",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script>!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","nzu0q");twq("track","PageView");</script>
</div><div style="display: none; visibility: hidden;"><script>!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","nve3t");twq("track","PageView");</script></div><div style="display: none; visibility: hidden;"><script type="text/javascript" language="javascript">var yahoo_retargeting_id="USSDKFK3A8",yahoo_retargeting_label="",yahoo_retargeting_page_type="",yahoo_retargeting_items=[{item_id:"",category_id:"",price:"",quantity:""}];</script>
<script type="text/javascript" language="javascript" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/s_retargeting.js"></script></div><div style="display: none; visibility: hidden;">
<script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/oct.js" type="text/javascript"></script>
<script type="text/javascript">twttr.conversion.trackPid("o03ez",{tw_sale_amount:0,tw_order_quantity:0});</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;">
<script>!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","o058w");twq("track","PageView");</script>
</div><div style="display: none; visibility: hidden;">
<script>!function(d,e,f,a,b,c){d.twq||(a=d.twq=function(){a.exe?a.exe.apply(a,arguments):a.queue.push(arguments)},a.version="1.1",a.queue=[],b=e.createElement(f),b.async=!0,b.src="//static.ads-twitter.com/uwt.js",c=e.getElementsByTagName(f)[0],c.parentNode.insertBefore(b,c))}(window,document,"script");twq("init","o0jpn");twq("track","PageView");</script>
</div><div style="display: none; visibility: hidden;"><script type="text/javascript">(function(d,g,h,l,e,k,c,a,b,f){a=(d[e]||(d[e]={}))[k]||(d[e][k]={});a[c]||(a[c]=function(){(a[c+"_queue"]||(a[c+"_queue"]=[])).push(arguments)},b=g.createElement(h),b.charset="utf-8",b.async=!0,b.src=l,f=g.getElementsByTagName(h)[0],f.parentNode.insertBefore(b,f))})(window,document,"script","https://cd.ladsp.com/script/pixel2.js","Smn","Logicad","pixel");Smn.Logicad.pixel({smnAdvertiserId:"00010559"});</script></div><div style="display: none; visibility: hidden;">

<script>(function(a,b,d){a._ltq=a._ltq||[];a._lt=a._lt||function(){a._ltq.push(arguments)};var e="https:"===location.protocol?"https://d.line-scdn.net":"http://d.line-cdn.net",c=b.createElement("script");c.async=1;c.src=d||e+"/n/line_tag/public/release/v1/lt.js";b=b.getElementsByTagName("script")[0];b.parentNode.insertBefore(c,b)})(window,document);_lt("init",{customerType:"lap",tagId:"0eae3c8c-4d76-4bed-ba44-6b29e627c570"});_lt("send","pv",["0eae3c8c-4d76-4bed-ba44-6b29e627c570"]);</script>
<noscript></noscript>
</div><div style="display: none; visibility: hidden;"><script async="null" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/ytag.js"></script>
<script>window.yjDataLayer=window.yjDataLayer||[];function ytag(){yjDataLayer.push(arguments)}ytag({type:"yss_retargeting",config:{yahoo_ss_retargeting_id:"1001117028",yahoo_sstag_custom_params:{}}});</script></div><div style="display: none; visibility: hidden;"><script async="null" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/ytag.js"></script>
<script>window.yjDataLayer=window.yjDataLayer||[];function ytag(){yjDataLayer.push(arguments)}ytag({type:"yjad_retargeting",config:{yahoo_retargeting_id:"L7W82OXY21",yahoo_retargeting_label:""}});</script></div><div style="display: none; visibility: hidden;"><script async="null" src="./HTML5 Canvas でドラッグ操作 - Qiita_files/ytag.js"></script>
<script>window.yjDataLayer=window.yjDataLayer||[];function ytag(){yjDataLayer.push(arguments)}ytag({type:"ycl_cookie"});</script></div><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(1)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(3)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(4)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(5)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(6)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(7)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(8)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(9)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(10)" type="text/javascript"></script><iframe src="./HTML5 Canvas でドラッグ操作 - Qiita_files/beacon.html" style="display: none;"></iframe><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(11)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(12)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(13)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(14)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(15)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(16)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(17)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(2)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(18)" type="text/javascript"></script><script src="./HTML5 Canvas でドラッグ操作 - Qiita_files/adsct(19)" type="text/javascript"></script></body></html>